{"version":3,"sources":["webpack:///./src/mixins/WidgetMixin.js","webpack:///./src/mixins/NextcloudMixin.js","webpack:///./src/components/Widgets/NextcloudStats.vue?9ac6","webpack:///./src/components/Widgets/NextcloudStats.vue","webpack:///src/components/Widgets/NextcloudStats.vue","webpack:///./src/components/Widgets/NextcloudStats.vue?a5aa","webpack:///./src/components/Widgets/NextcloudStats.vue?615b"],"names":["WidgetMixin","props","options","type","Object","default","data","progress","Progress","color","overrideProxyChoice","overrideUpdateInterval","disableLoader","updater","defaultTimeout","mounted","this","fetchData","updateInterval","continuousUpdates","beforeDestroy","clearInterval","computed","proxyReqEndpoint","baseUrl","process","VUE_APP_DOMAIN","window","location","origin","concat","serviceEndpoints","corsProxy","useProxy","usersInterval","methods","update","startLoading","_this","setInterval","error","msg","stackTrace","ErrorHandler","ignoreErrors","$emit","start","finishLoading","_this2","setTimeout","end","tooltip","content","html","arguments","length","undefined","trigger","delay","makeRequest","endpoint","protocol","body","_this3","method","url","JSON","stringify","CustomHeaders","headers","timeout","requestConfig","Promise","resolve","reject","axios","request","then","response","success","message","catch","dataFetchError","finally","validCredentials","capabilities","notifications","enabled","features","userStatus","capabilitiesLastUpdated","branding","name","logo","slogan","version","string","edition","hostname","username","password","test","authBase","Accept","Authorization","btoa","capabilitiesTtl","parseInt","id","hasValidCredentials","validateResponse","_response$ocs","_response$ocs2","ocs","meta","status","statuscode","allowedStatuscodes","includes","loadCapabilities","Date","getTime","processCapabilities","capResponse","_ocdata$capabilities","_ocdata$capabilities2","_ocdata$capabilities3","_ocdata$version","_ocdata$version2","ocdata","capNotif","theming","user_status","getTimeAgo","time","formatDateTime","timestampToDateTime","convertBytes","bytes","decimals","formatHtml","formatted","toString","m","match","formatNumber","number","formatPercent","n","parseFloat","toFixed","split","d","getValueFromCss","colorVar","cssProps","getComputedStyle","$el","document","documentElement","getPropertyValue","trim","getColorRgba","alpha","_this$getValueFromCss","map","x","_this$getValueFromCss2","_slicedToArray","r","g","b","tt","key","$t","render","_vm","_c","_self","didLoadData","staticClass","activeUsers","directives","rawName","value","activeUsersTooltip","expression","domProps","_s","storage","num_users","_v","last24hours","_e","nextcloud","appUpdatesTooltip","apps","num_installed","num_updates_available","plural","attrs","storagesTooltip","num_files","num_storages","system","freespace","sharesTooltip","shares","num_shares","num_fed_shares_sent","num_fed_shares_received","staticRenderFns","mixins","NextcloudMixin","components","app_updates","num_shares_user","num_shares_groups","num_shares_link","num_shares_mail","num_shares_room","num_shares_link_no_password","last5minutes","last1hour","_this$system","processServerInfo","serverResponse","toLocaleString","classes","entries","forEach","_ref","_ref2","app","num_storages_local","num_storages_home","num_storages_other","created","component"],"mappings":"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","file":"js/chunk-3b85e328.227556c9.js","sourcesContent":["/**\n * Mixin that all pre-built and custom widgets extend from.\n * Manages loading state, error handling, data updates and user options\n */\nimport axios from 'axios';\nimport { Progress } from 'rsup-progress';\nimport ErrorHandler from '@/utils/ErrorHandler';\nimport { serviceEndpoints } from '@/utils/defaults';\n\nconst WidgetMixin = {\n  props: {\n    options: {\n      type: Object,\n      default: {},\n    },\n  },\n  data: () => ({\n    progress: new Progress({ color: 'var(--progress-bar)' }),\n    overrideProxyChoice: false,\n    overrideUpdateInterval: null,\n    disableLoader: false, // Prevent ever showing the loader\n    updater: null, // Stores interval\n    defaultTimeout: 50000,\n  }),\n  /* When component mounted, fetch initial data */\n  mounted() {\n    this.fetchData();\n    if (this.updateInterval) {\n      this.continuousUpdates();\n      this.disableLoader = true;\n    }\n  },\n  beforeDestroy() {\n    if (this.updater) {\n      clearInterval(this.updater);\n    }\n  },\n  computed: {\n    proxyReqEndpoint() {\n      const baseUrl = process.env.VUE_APP_DOMAIN || window.location.origin;\n      return `${baseUrl}${serviceEndpoints.corsProxy}`;\n    },\n    useProxy() {\n      return this.options.useProxy || this.overrideProxyChoice;\n    },\n    /* Returns either a number in ms to continuously update widget data. Or 0 for no updates */\n    updateInterval() {\n      const usersInterval = this.options.updateInterval;\n      if (usersInterval === null && this.overrideUpdateInterval) {\n        return this.overrideUpdateInterval * 1000;\n      }\n      if (!usersInterval) return 0;\n      // If set to `true`, then default to 30 seconds\n      if (typeof usersInterval === 'boolean') return 30 * 1000;\n      // If set to a number, and within valid range, return user choice\n      if (typeof usersInterval === 'number'\n        && usersInterval >= 2\n        && usersInterval <= 7200) {\n        return usersInterval * 1000;\n      }\n      return 0;\n    },\n  },\n  methods: {\n    /* Re-fetches external data, called by parent. Usually overridden by widget */\n    update() {\n      this.startLoading();\n      this.fetchData();\n    },\n    /* If continuous updates enabled, create interval */\n    continuousUpdates() {\n      this.updater = setInterval(() => { this.update(); }, this.updateInterval);\n    },\n    /* Called when an error occurs. Logs to handler, and passes to parent component */\n    error(msg, stackTrace) {\n      ErrorHandler(msg, stackTrace);\n      if (!this.options.ignoreErrors) {\n        this.$emit('error', msg);\n      }\n    },\n    /* When a data request update starts, show loader */\n    startLoading() {\n      if (!this.disableLoader) {\n        this.$emit('loading', true);\n        this.progress.start();\n      }\n    },\n    /* When a data request finishes, hide loader */\n    finishLoading() {\n      this.$emit('loading', false);\n      setTimeout(() => { this.progress.end(); }, 500);\n    },\n    /* Overridden by child component. Will make network request, then end loader */\n    fetchData() {\n      this.finishLoading();\n    },\n    /* Used as v-tooltip, pass text content in, and will show on hover */\n    tooltip(content, html = false) {\n      return {\n        content, html, trigger: 'hover focus', delay: 250,\n      };\n    },\n    /* Makes data request, returns promise */\n    makeRequest(endpoint, options, protocol, body) {\n      // Request Options\n      const method = protocol || 'GET';\n      const url = this.useProxy ? this.proxyReqEndpoint : endpoint;\n      const data = JSON.stringify(body || {});\n      const CustomHeaders = options || null;\n      const headers = this.useProxy\n        ? { 'Target-URL': endpoint, CustomHeaders: JSON.stringify(CustomHeaders) } : CustomHeaders;\n      const timeout = this.options.timeout || this.defaultTimeout;\n      const requestConfig = {\n        method, url, headers, data, timeout,\n      };\n      // Make request\n      return new Promise((resolve, reject) => {\n        axios.request(requestConfig)\n          .then((response) => {\n            if (response.data.success === false) {\n              this.error('Proxy returned error from target server', response.data.message);\n            }\n            resolve(response.data);\n          })\n          .catch((dataFetchError) => {\n            this.error('Unable to fetch data', dataFetchError);\n            reject(dataFetchError);\n          })\n          .finally(() => {\n            this.finishLoading();\n          });\n      });\n    },\n  },\n};\n\nexport default WidgetMixin;\n","import { serviceEndpoints } from '@/utils/defaults';\nimport {\n  convertBytes, formatNumber, getTimeAgo, timestampToDateTime,\n} from '@/utils/MiscHelpers';\n\n/**\n * Reusable mixin for Nextcloud widgets\n * Nextcloud APIs\n *  - capabilities: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-api-overview.html#capabilities-api\n *  - userstatus: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-status-api.html#user-status-retrieve-statuses\n *  - user: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-api-overview.html#user-metadata\n *  - notifications: https://github.com/nextcloud/notifications/blob/master/docs/ocs-endpoint-v2.md\n *  - serverinfo: https://github.com/nextcloud/serverinfo\n */\nexport default {\n  data() {\n    return {\n      validCredentials: null,\n      capabilities: {\n        notifications: {\n          enabled: null,\n          features: [],\n        },\n        userStatus: null,\n      },\n      capabilitiesLastUpdated: 0,\n      branding: {\n        name: null,\n        logo: null,\n        url: null,\n        slogan: null,\n      },\n      version: {\n        string: null,\n        edition: null,\n      },\n    };\n  },\n  computed: {\n    /* The user provided Nextcloud hostname */\n    hostname() {\n      if (!this.options.hostname) this.error('A hostname is required');\n      return this.options.hostname;\n    },\n    /* The user provided Nextcloud username */\n    username() {\n      if (!this.options.username) this.error('A username is required');\n      return this.options.username;\n    },\n    /* The user provided Nextcloud password */\n    password() {\n      if (!this.options.password) this.error('An app-password is required');\n      // reject Nextcloud user passord (enforce 'app-password')\n      if (!/^([a-z0-9]{5}-){4}[a-z0-9]{5}$/i.test(this.options.password)) {\n        this.error('Please use a Nextcloud app-password, not your login password.');\n        return '';\n      }\n      return this.options.password;\n    },\n    /* HTTP headers for Nextcloud API requests */\n    headers() {\n      const authBase = `${this.username}:${this.password}`;\n      return {\n        'OCS-APIREQUEST': true,\n        Accept: 'application/json',\n        Authorization: `Basic ${window.btoa(authBase)}`,\n      };\n    },\n    /* TTL for data delivered by the capabilities endpoint, ms */\n    capabilitiesTtl() {\n      return (parseInt(this.options.capabilitiesTtl, 10) || 3600) * 1000;\n    },\n    proxyReqEndpoint() {\n      const baseUrl = process.env.VUE_APP_DOMAIN || window.location.origin;\n      return `${baseUrl}${serviceEndpoints.corsProxy}`;\n    },\n  },\n  methods: {\n    /* Nextcloud API endpoints */\n    endpoint(id) {\n      switch (id) {\n        case 'user':\n          return `${this.hostname}/ocs/v1.php/cloud/users/${this.username}`;\n        case 'userstatus':\n          return `${this.hostname}/ocs/v2.php/apps/user_status/api/v1/statuses`;\n        case 'serverinfo':\n          return `${this.hostname}/ocs/v2.php/apps/serverinfo/api/v1/info`;\n        case 'notifications':\n          return `${this.hostname}/ocs/v2.php/apps/notifications/api/v2/notifications`;\n        case 'capabilities':\n        default:\n          return `${this.hostname}/ocs/v1.php/cloud/capabilities`;\n      }\n    },\n    /* Helper for widgets to terminate {fetchData} early */\n    hasValidCredentials() {\n      return this.validCredentials !== false\n             && this.username.length > 0\n             && this.password.length > 0;\n    },\n    /* Primary handler for every Nextcloud API response */\n    validateResponse(response) {\n      const data = response?.ocs?.data;\n      let meta = response?.ocs?.meta;\n      const error = response?.error; // Dashy error when cors-proxied\n      if (error && error.status) {\n        meta = { statuscode: error.status };\n      }\n      if (!meta || !meta.statuscode || !data) {\n        this.error('Invalid response');\n      }\n      switch (meta.statuscode) {\n        case 401:\n          this.validCredentials = false;\n          this.error(\n            `Access denied for user ${this.username}.`\n            + ' Note that some Nextcloud widgets only work with an admin user.',\n          );\n          break;\n        case 429:\n          this.validCredentials = false;\n          this.error(\n            'The server indicated \\'rate-limit reached\\' error (HTTP 429).'\n            + ' The server-info API may return this error for incorrect user/password.',\n          );\n          break;\n        case 993:\n        case 997:\n        case 998:\n          this.validCredentials = false;\n          this.error(\n            'The provided app-password is not permitted to access the requested resource or it has'\n            + ' been revoked, or the username/password combination is incorrect',\n          );\n          break;\n        default:\n          this.validCredentials = true;\n          if (!this.allowedStatuscodes().includes(meta.statuscode)) {\n            this.error('Unexpected response');\n          }\n          break;\n      }\n      return data;\n    },\n    /* Process the capabilities endpoint if {capabilitiesTtl} has expired */\n    loadCapabilities() {\n      if ((new Date().getTime()) - this.capabilitiesLastUpdated > this.capabilitiesTtl) {\n        return this.makeRequest(this.endpoint('capabilities'), this.headers)\n          .then(this.processCapabilities);\n      }\n      return Promise.resolve();\n    },\n    /* Update the sate based on the capabilites response */\n    processCapabilities(capResponse) {\n      const ocdata = this.validateResponse(capResponse);\n      const capNotif = ocdata.capabilities?.notifications?.['ocs-endpoints'];\n      this.branding = ocdata.capabilities?.theming;\n      this.capabilities.notifications.enabled = !!(capNotif?.length);\n      this.capabilities.notifications.features = capNotif || [];\n      this.capabilities.userStatus = !!(ocdata.capabilities?.user_status?.enabled);\n      this.version.string = ocdata.version?.string;\n      this.version.edition = ocdata.version?.edition;\n      this.capabilitiesLastUpdated = new Date().getTime();\n    },\n    /* Shared template helpers */\n    getTimeAgo(time) {\n      return getTimeAgo(time);\n    },\n    formatDateTime(time) {\n      return timestampToDateTime(time);\n    },\n    /* Add additional formatting to {MiscHelpers.convertBytes()} */\n    convertBytes(bytes, decimals = 2, formatHtml = true) {\n      const formatted = convertBytes(bytes, decimals).toString();\n      if (!formatHtml) return formatted;\n      const m = formatted.match(/(-?\\d+)((\\.\\d+)?\\s(([KMGTPEZY]B|Bytes)))/);\n      return `${m[1]}<span class=\"decimals\">${m[2]}</span>`;\n    },\n    /* Add additional formatting to {MiscHelpers.formatNumber()} */\n    formatNumber(number, decimals = 1, formatHtml = true) {\n      const formatted = formatNumber(number, decimals).toString();\n      if (!formatHtml) return formatted;\n      const m = formatted.match(/(\\d+)((\\.\\d+)?([KMBT]?))/);\n      return `${m[1]}<span class=\"decimals\">${m[2]}</span>`;\n    },\n    /* Format a number as percentage value */\n    formatPercent(number, decimals = 2) {\n      const n = parseFloat(number).toFixed(decimals).split('.');\n      const d = n.length > 1 ? `.${n[1]}` : '';\n      return `${n[0]}<span class=\"decimals\">${d}%</span>`;\n    },\n    /* Similar to {MiscHelpers.getValueFromCss()} but uses the widget root node to get\n     * the computed style so widget color is respected in variable widget color themes. */\n    getValueFromCss(colorVar) {\n      const cssProps = getComputedStyle(this.$el || document.documentElement);\n      return cssProps.getPropertyValue(`--${colorVar}`).trim();\n    },\n    /* Get {colorVar} CSS property value and return as rgba() */\n    getColorRgba(colorVar, alpha = 1) {\n      const [r, g, b] = this.getValueFromCss(colorVar).match(/\\w\\w/g).map(x => parseInt(x, 16));\n      return `rgba(${r},${g},${b},${alpha})`;\n    },\n    /* Translation shorthand with key prefix */\n    tt(key, options = null) {\n      return this.$t(`widgets.nextcloud.${key}`, options);\n    },\n  },\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudStats.vue?vue&type=style&index=0&id=ff16f3da&prod&scoped=true&lang=scss\"","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.didLoadData)?_c('div',{staticClass:\"nextcloud-widget nextcloud-stats-wrapper\"},[_c('div',{staticClass:\"server-info sep\"},[(_vm.activeUsers)?_c('div',[_c('p',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.activeUsersTooltip()),expression:\"activeUsersTooltip()\"}]},[_c('i',{staticClass:\"fal fa-user\"}),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatNumber(_vm.storage.num_users))}}),_c('strong',[_vm._v(_vm._s(_vm.tt('total-users')))]),_vm._v(\" \"),_c('small',[_vm._v(_vm._s(_vm.tt('of-which')))]),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatNumber(_vm.activeUsers.last24hours))}}),_c('strong',[_vm._v(_vm._s(_vm.tt('active')))]),_vm._v(\" \"),_c('small',[_vm._v(\"(\"+_vm._s(_vm.tt('last-24-hours'))+\")\")])])]):_vm._e(),_c('hr'),(_vm.nextcloud)?_c('div',[_c('p',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.appUpdatesTooltip()),expression:\"appUpdatesTooltip()\"}]},[_c('i',{staticClass:\"fal fa-browser\"}),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatNumber(_vm.apps.num_installed))}}),_c('strong',[_vm._v(_vm._s(_vm.tt('applications')))]),(_vm.apps.num_updates_available)?_c('span',{staticClass:\"nc-updates\"},[_c('i',{staticClass:\"fal fa-download\"}),_c('em',[_vm._v(_vm._s(_vm.apps.num_updates_available))]),_c('strong',[_vm._v(\" \"+_vm._s(_vm.tt('updates-available', {plural: _vm.apps.num_updates_available > 1 ? 's' : ''}))+\" \")])]):_c('small',{staticClass:\"disabled\",attrs:{\"data-nc-updates\":\"\"}},[_vm._v(_vm._s(_vm.tt('no-pending-updates')))])]),_c('hr'),_c('p',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.storagesTooltip()),expression:\"storagesTooltip()\"}]},[_c('i',{staticClass:\"fal fa-file\"}),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatNumber(_vm.storage.num_files))}}),_c('strong',[_vm._v(_vm._s(_vm.tt('files', { plural: _vm.storage.num_files > 1 ? 's' : '' })))]),_vm._v(\"  \"),_c('small',[_vm._v(_vm._s(_vm.tt('in')))]),_c('em',[_vm._v(_vm._s(_vm.storage.num_storages))]),_c('strong',[_vm._v(_vm._s(_vm.tt('storages', { plural: _vm.storage.num_storages > 1 ? 's' : '' })))]),_vm._v(\"  • \"),_c('strong',{domProps:{\"innerHTML\":_vm._s(_vm.convertBytes(_vm.system.freespace))}}),_vm._v(\"  \"),_c('small',[_vm._v(_vm._s(_vm.tt('free')))])]),_c('hr'),_c('p',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.sharesTooltip()),expression:\"sharesTooltip()\"}]},[_c('i',{staticClass:\"fal fa-share\"}),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatNumber(_vm.shares.num_shares))}}),_c('strong',[_vm._v(_vm._s(_vm.tt('local')))]),_vm._v(\" \"),_c('small',[_vm._v(\" \"+_vm._s(_vm.tt('and')))]),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatNumber(_vm.shares.num_fed_shares_sent\n                 + _vm.shares.num_fed_shares_received))}}),_c('strong',[_vm._v(\" \"+_vm._s(_vm.tt('federated-shares'))+\" \")])]),_c('hr')]):_vm._e()])]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div v-if=\"didLoadData\" class=\"nextcloud-widget nextcloud-stats-wrapper\">\n  <div class=\"server-info sep\">\n    <!-- server info: users -->\n    <div v-if=\"activeUsers\">\n      <p v-tooltip=\"activeUsersTooltip()\">\n        <i class=\"fal fa-user\"></i>\n        <em v-html=\"formatNumber(storage.num_users)\"></em>\n        <strong>{{ tt('total-users') }}</strong> <small>{{ tt('of-which') }}</small>\n        <em v-html=\"formatNumber(activeUsers.last24hours)\"></em>\n        <strong>{{ tt('active') }}</strong> <small>({{ tt('last-24-hours') }})</small>\n      </p>\n    </div>\n    <hr />\n    <div v-if=\"nextcloud\">\n      <!-- server info: apps -->\n      <p v-tooltip=\"appUpdatesTooltip()\">\n        <i class=\"fal fa-browser\"></i>\n        <em v-html=\"formatNumber(apps.num_installed)\"></em>\n        <strong>{{ tt('applications') }}</strong>\n        <span v-if=\"apps.num_updates_available\" class=\"nc-updates\">\n          <i class=\"fal fa-download\"></i><em>{{ apps.num_updates_available }}</em>\n          <strong>\n            {{ tt('updates-available',\n            {plural: apps.num_updates_available > 1 ? 's' : ''}) }}\n          </strong>\n        </span>\n        <small v-else data-nc-updates class=\"disabled\">{{ tt('no-pending-updates') }}</small>\n      </p>\n      <hr />\n      <!-- server info: storage -->\n      <p v-tooltip=\"storagesTooltip()\">\n        <i class=\"fal fa-file\"></i><em v-html=\"formatNumber(storage.num_files)\"></em>\n        <strong>{{ tt('files', { plural: storage.num_files > 1 ? 's' : '' }) }}</strong>&nbsp;\n        <small>{{ tt('in') }}</small><em>{{ storage.num_storages }}</em>\n        <strong>{{ tt('storages', { plural: storage.num_storages > 1 ? 's' : '' }) }}</strong>\n        &nbsp;•&nbsp;<strong v-html=\"convertBytes(system.freespace)\"></strong>&nbsp;\n        <small>{{ tt('free') }}</small>\n      </p>\n      <hr />\n      <!-- server info: shares -->\n      <p v-tooltip=\"sharesTooltip()\">\n        <i class=\"fal fa-share\"></i>\n        <em v-html=\"formatNumber(shares.num_shares)\"></em>\n        <strong>{{ tt('local') }}</strong> <small> {{ tt('and') }}</small>\n        <em v-html=\"formatNumber(shares.num_fed_shares_sent\n                 + shares.num_fed_shares_received)\"></em>\n        <strong>\n          {{ tt('federated-shares') }}\n        </strong>\n      </p>\n      <hr />\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport WidgetMixin from '@/mixins/WidgetMixin';\nimport NextcloudMixin from '@/mixins/NextcloudMixin';\n\n/**\n * NextcloudStats widget - Shows statistics about Nextcloud usage\n * Used endpoints\n *  - serverinfo: requires Nextcloud admin user\n */\n\nexport default {\n  mixins: [WidgetMixin, NextcloudMixin],\n  components: {},\n  data() {\n    return {\n      nextcloud: {\n        system: {\n          freespace: null,\n          apps: {\n            num_installed: null,\n            num_updates_available: 0,\n            app_updates: [],\n          },\n        },\n        storage: {\n          num_users: null,\n          num_files: null,\n          num_storages: null,\n        },\n        shares: {\n          num_shares: null,\n          num_shares_user: null,\n          num_shares_groups: null,\n          num_shares_link: null,\n          num_shares_mail: null,\n          num_shares_room: null,\n          num_shares_link_no_password: null,\n          num_fed_shares_sent: null,\n          num_fed_shares_received: null,\n        },\n      },\n      activeUsers: {\n        last5minutes: null,\n        last1hour: null,\n        last24hours: null,\n      },\n    };\n  },\n  computed: {\n    didLoadData() {\n      return !!(this?.system?.freespace);\n    },\n    // data shortcuts\n    system() {\n      return this.nextcloud.system;\n    },\n    storage() {\n      return this.nextcloud.storage;\n    },\n    shares() {\n      return this.nextcloud.shares;\n    },\n    apps() {\n      return this.nextcloud.system.apps;\n    },\n  },\n  methods: {\n    allowedStatuscodes() {\n      return [200];\n    },\n    fetchData() {\n      if (!this.hasValidCredentials()) return;\n      this.makeRequest(this.endpoint('serverinfo'), this.headers)\n        .then(this.processServerInfo)\n        .finally(this.finishLoading);\n    },\n    processServerInfo(serverResponse) {\n      const data = this.validateResponse(serverResponse);\n      this.nextcloud = data.nextcloud;\n      this.activeUsers = data.activeUsers;\n    },\n    /* Tooltip generators */\n    activeUsersTooltip() {\n      const content = `${parseFloat(this.activeUsers.last5minutes).toLocaleString()}`\n                    + ` ${this.tt('last-5-minutes')}<br>`\n                    + `${parseFloat(this.activeUsers.last1hour).toLocaleString()}`\n                    + ` ${this.tt('last-hour')}<br>`;\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n    appUpdatesTooltip() {\n      let content = `<strong>${this.tt('updates-available-for')}</strong><ul>`;\n      Object.entries(this.system.apps.app_updates).forEach(([app, version]) => {\n        content += `<li>${app}: ${version}</li>`;\n      });\n      content += '</ul>';\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n    storagesTooltip() {\n      const content = `<strong>${this.tt('storages-by-type')}</strong><ul><li>`\n        + `${parseFloat(this.storage.num_storages_local).toLocaleString()} ${this.tt('local')}</li><li>`\n        + `${parseFloat(this.storage.num_storages_home).toLocaleString()} ${this.tt('home')}</li><li>`\n        + `${parseFloat(this.storage.num_storages_other).toLocaleString()} ${this.tt('other')}</li></ul>`\n        + `${parseFloat(this.storage.num_files).toLocaleString()} ${this.tt('total-files')}`;\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n    sharesTooltip() {\n      const content = `<strong>${this.tt('local-shares')}</strong><ul><li>`\n        + `${parseFloat(this.shares.num_shares_user).toLocaleString()} ${this.tt('user')}</li><li>`\n        + `${parseFloat(this.shares.num_shares_groups).toLocaleString()} ${this.tt('groups')}</li><li>`\n        + `${parseFloat(this.shares.num_shares_mail).toLocaleString()} ${this.tt('email')}</li><li>`\n        + `${parseFloat(this.shares.num_shares_room).toLocaleString()} ${this.tt('chat-room')}</li><li>`\n        + `${parseFloat(this.shares.num_shares_link).toLocaleString()} ${this.tt('private-link')}</li><li>`\n        + `${parseFloat(this.shares.num_shares_link_no_password).toLocaleString()} ${this.tt('public-link')}</li></ul>`\n        + `<strong>${this.tt('federated-shares-ucfirst')}</strong><ul><li>`\n        + `${parseFloat(this.shares.num_fed_shares_sent).toLocaleString()} ${this.tt('sent')}</li><li>`\n        + `${parseFloat(this.shares.num_fed_shares_received).toLocaleString()} ${this.tt('received')}</li></ul>`;\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n  },\n  created() {\n    this.overrideUpdateInterval = 20;\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '@/styles/widgets/nextcloud-shared.scss';\n.nextcloud-stats-wrapper {\n  div.server-info .nc-updates {\n    color: var(--success);\n    margin-left: .5em;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudStats.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudStats.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./NextcloudStats.vue?vue&type=template&id=ff16f3da&scoped=true\"\nimport script from \"./NextcloudStats.vue?vue&type=script&lang=js\"\nexport * from \"./NextcloudStats.vue?vue&type=script&lang=js\"\nimport style0 from \"./NextcloudStats.vue?vue&type=style&index=0&id=ff16f3da&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ff16f3da\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}