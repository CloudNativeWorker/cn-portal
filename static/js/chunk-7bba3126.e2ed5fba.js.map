{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.object.values.js","webpack:///./src/mixins/WidgetMixin.js","webpack:///./src/components/Widgets/NextcloudUserStatus.vue","webpack:///src/components/Widgets/NextcloudUserStatus.vue","webpack:///./src/components/Widgets/NextcloudUserStatus.vue?1a98","webpack:///./src/components/Widgets/NextcloudUserStatus.vue?189d","webpack:///./src/mixins/NextcloudMixin.js","webpack:///./src/components/Widgets/NextcloudUserStatus.vue?ee73"],"names":["$","$values","values","target","stat","O","WidgetMixin","props","options","type","Object","default","data","progress","Progress","color","overrideProxyChoice","overrideUpdateInterval","disableLoader","updater","defaultTimeout","mounted","this","fetchData","updateInterval","continuousUpdates","beforeDestroy","clearInterval","computed","proxyReqEndpoint","baseUrl","process","VUE_APP_DOMAIN","window","location","origin","concat","serviceEndpoints","corsProxy","useProxy","usersInterval","methods","update","startLoading","_this","setInterval","error","msg","stackTrace","ErrorHandler","ignoreErrors","$emit","start","finishLoading","_this2","setTimeout","end","tooltip","content","html","arguments","length","undefined","trigger","delay","makeRequest","endpoint","protocol","body","_this3","method","url","JSON","stringify","CustomHeaders","headers","timeout","requestConfig","Promise","resolve","reject","axios","request","then","response","success","message","catch","dataFetchError","finally","render","_vm","_c","_self","staticClass","didLoadData","_l","statuses","status","userId","key","_v","_s","icon","directives","name","rawName","value","clearAtTooltip","clearAt","expression","_e","class","tt","staticRenderFns","fetchStrategies","allAtOnce","oneByOne","mixins","NextcloudMixin","components","keys","fetchStrategy","includes","users","Array","isArray","slice","showEmpty","allowedStatuscodes","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this$capabilities","promises","wrap","_context","prev","next","hasValidCredentials","abrupt","loadCapabilities","capabilities","userStatus","processStatuses","newStatuses","forEach","user","push","processStatus","all","stop","validateResponse","raw","clearAtTime","Date","toLocaleString","classes","created","component","validCredentials","notifications","enabled","features","capabilitiesLastUpdated","branding","logo","slogan","version","string","edition","hostname","username","password","test","authBase","Accept","Authorization","btoa","capabilitiesTtl","parseInt","id","_response$ocs","_response$ocs2","ocs","meta","statuscode","getTime","processCapabilities","capResponse","_ocdata$capabilities","_ocdata$capabilities2","_ocdata$capabilities3","_ocdata$version","_ocdata$version2","ocdata","capNotif","theming","user_status","getTimeAgo","time","formatDateTime","timestampToDateTime","convertBytes","bytes","decimals","formatHtml","formatted","toString","m","match","formatNumber","number","formatPercent","n","parseFloat","toFixed","split","d","getValueFromCss","colorVar","cssProps","getComputedStyle","$el","document","documentElement","getPropertyValue","trim","getColorRgba","alpha","_this$getValueFromCss","map","x","_this$getValueFromCss2","_slicedToArray","r","g","b","$t"],"mappings":"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","file":"js/chunk-7bba3126.e2ed5fba.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $values = require('../internals/object-to-array').values;\n\n// `Object.values` method\n// https://tc39.es/ecma262/#sec-object.values\n$({ target: 'Object', stat: true }, {\n  values: function values(O) {\n    return $values(O);\n  }\n});\n","/**\n * Mixin that all pre-built and custom widgets extend from.\n * Manages loading state, error handling, data updates and user options\n */\nimport axios from 'axios';\nimport { Progress } from 'rsup-progress';\nimport ErrorHandler from '@/utils/ErrorHandler';\nimport { serviceEndpoints } from '@/utils/defaults';\n\nconst WidgetMixin = {\n  props: {\n    options: {\n      type: Object,\n      default: {},\n    },\n  },\n  data: () => ({\n    progress: new Progress({ color: 'var(--progress-bar)' }),\n    overrideProxyChoice: false,\n    overrideUpdateInterval: null,\n    disableLoader: false, // Prevent ever showing the loader\n    updater: null, // Stores interval\n    defaultTimeout: 50000,\n  }),\n  /* When component mounted, fetch initial data */\n  mounted() {\n    this.fetchData();\n    if (this.updateInterval) {\n      this.continuousUpdates();\n      this.disableLoader = true;\n    }\n  },\n  beforeDestroy() {\n    if (this.updater) {\n      clearInterval(this.updater);\n    }\n  },\n  computed: {\n    proxyReqEndpoint() {\n      const baseUrl = process.env.VUE_APP_DOMAIN || window.location.origin;\n      return `${baseUrl}${serviceEndpoints.corsProxy}`;\n    },\n    useProxy() {\n      return this.options.useProxy || this.overrideProxyChoice;\n    },\n    /* Returns either a number in ms to continuously update widget data. Or 0 for no updates */\n    updateInterval() {\n      const usersInterval = this.options.updateInterval;\n      if (usersInterval === null && this.overrideUpdateInterval) {\n        return this.overrideUpdateInterval * 1000;\n      }\n      if (!usersInterval) return 0;\n      // If set to `true`, then default to 30 seconds\n      if (typeof usersInterval === 'boolean') return 30 * 1000;\n      // If set to a number, and within valid range, return user choice\n      if (typeof usersInterval === 'number'\n        && usersInterval >= 2\n        && usersInterval <= 7200) {\n        return usersInterval * 1000;\n      }\n      return 0;\n    },\n  },\n  methods: {\n    /* Re-fetches external data, called by parent. Usually overridden by widget */\n    update() {\n      this.startLoading();\n      this.fetchData();\n    },\n    /* If continuous updates enabled, create interval */\n    continuousUpdates() {\n      this.updater = setInterval(() => { this.update(); }, this.updateInterval);\n    },\n    /* Called when an error occurs. Logs to handler, and passes to parent component */\n    error(msg, stackTrace) {\n      ErrorHandler(msg, stackTrace);\n      if (!this.options.ignoreErrors) {\n        this.$emit('error', msg);\n      }\n    },\n    /* When a data request update starts, show loader */\n    startLoading() {\n      if (!this.disableLoader) {\n        this.$emit('loading', true);\n        this.progress.start();\n      }\n    },\n    /* When a data request finishes, hide loader */\n    finishLoading() {\n      this.$emit('loading', false);\n      setTimeout(() => { this.progress.end(); }, 500);\n    },\n    /* Overridden by child component. Will make network request, then end loader */\n    fetchData() {\n      this.finishLoading();\n    },\n    /* Used as v-tooltip, pass text content in, and will show on hover */\n    tooltip(content, html = false) {\n      return {\n        content, html, trigger: 'hover focus', delay: 250,\n      };\n    },\n    /* Makes data request, returns promise */\n    makeRequest(endpoint, options, protocol, body) {\n      // Request Options\n      const method = protocol || 'GET';\n      const url = this.useProxy ? this.proxyReqEndpoint : endpoint;\n      const data = JSON.stringify(body || {});\n      const CustomHeaders = options || null;\n      const headers = this.useProxy\n        ? { 'Target-URL': endpoint, CustomHeaders: JSON.stringify(CustomHeaders) } : CustomHeaders;\n      const timeout = this.options.timeout || this.defaultTimeout;\n      const requestConfig = {\n        method, url, headers, data, timeout,\n      };\n      // Make request\n      return new Promise((resolve, reject) => {\n        axios.request(requestConfig)\n          .then((response) => {\n            if (response.data.success === false) {\n              this.error('Proxy returned error from target server', response.data.message);\n            }\n            resolve(response.data);\n          })\n          .catch((dataFetchError) => {\n            this.error('Unable to fetch data', dataFetchError);\n            reject(dataFetchError);\n          })\n          .finally(() => {\n            this.finishLoading();\n          });\n      });\n    },\n  },\n};\n\nexport default WidgetMixin;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"nextcloud-widget nextcloud-user-status-wrapper\"},[(_vm.didLoadData)?_c('div',{staticClass:\"sep\"},_vm._l((_vm.statuses),function(status,userId){return _c('div',{key:userId,staticClass:\"user\"},[_c('div',[_c('div',[_c('i',[_vm._v(_vm._s(status.icon))])]),_c('div',[_c('p',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.clearAtTooltip(status.clearAt)),expression:\"clearAtTooltip(status.clearAt)\"}]},[_c('strong',[_vm._v(_vm._s(status.userId))]),_vm._v(\"  \"),(status.clearAt)?_c('small',[_c('i',{staticClass:\"fal fa-clock\"})]):(status.message)?_c('span',[_vm._v(\"•\")]):_vm._e(),_c('em',[_vm._v(_vm._s(status.message))])])]),_c('div',[_c('p',[_c('small',{class:`status ${status.status}`},[(status.status === 'online' || status.status === 'dnd')?_c('i',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.tt(status.status)),expression:\"tt(status.status)\"}],staticClass:\"fas fa-circle\"}):_c('i',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.tt(status.status)),expression:\"tt(status.status)\"}],staticClass:\"far fa-circle\"})])])])]),_c('hr')])}),0):_c('div',{staticClass:\"sep\"},[_c('p',[_vm._v(_vm._s(_vm.tt('nothing-to-show')))])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"nextcloud-widget nextcloud-user-status-wrapper\">\n  <div v-if=\"didLoadData\" class=\"sep\">\n    <!-- user statuses: list -->\n    <div v-for=\"(status, userId) in statuses\" :key=\"userId\" class=\"user\">\n      <div>\n        <!-- user status: emoji -->\n        <div>\n          <i>{{ status.icon }}</i>\n        </div>\n        <!-- user status: message -->\n        <div>\n          <p v-tooltip=\"clearAtTooltip(status.clearAt)\">\n            <strong>{{ status.userId }}</strong>&nbsp;\n            <small v-if=\"status.clearAt\"><i class=\"fal fa-clock\"></i></small>\n            <span v-else-if=\"status.message\">•</span><em>{{ status.message }}</em>\n          </p>\n        </div>\n        <!-- user status: status -->\n        <div>\n          <p>\n            <small :class=\"`status ${status.status}`\">\n              <i v-if=\"status.status === 'online' || status.status === 'dnd'\"\n                class=\"fas fa-circle\" v-tooltip=\"tt(status.status)\"></i>\n              <i v-else class=\"far fa-circle\" v-tooltip=\"tt(status.status)\"></i>\n            </small>\n          </p>\n        </div>\n      </div>\n      <hr/>\n    </div>\n  </div>\n   <!-- user statuses: no content -->\n  <div v-else class=\"sep\"><p>{{ tt('nothing-to-show') }}</p></div>\n</div>\n</template>\n\n<script>\nimport WidgetMixin from '@/mixins/WidgetMixin';\nimport NextcloudMixin from '@/mixins/NextcloudMixin';\n\n// Nextcloud User Status API supports getting all user statuses at once\n// or a single user's status. {fetchStrategy} determines which of these methods to use.\nconst fetchStrategies = {\n  allAtOnce: 'AllAtOnce',\n  oneByOne: 'OneByOne',\n};\n\n/**\n * NextcloudUserStatus widget - Displays user statuses\n * Used endpoints\n *  - capabilities: to determine if the User Status API is enabled\n *  - userstatus: to fetch a single or all user statuses\n */\nexport default {\n  mixins: [WidgetMixin, NextcloudMixin],\n  components: {},\n  computed: {\n    didLoadData() {\n      return !!Object.keys(this?.statuses || {}).length;\n    },\n    fetchStrategy() {\n      if (!this.options.fetchStrategy) {\n        return fetchStrategies.allAtOnce;\n      }\n      if (!Object.values(fetchStrategies).includes(this.options.fetchStrategy)) {\n        return fetchStrategies.allAtOnce;\n      }\n      return this.options.fetchStrategy;\n    },\n    users() {\n      if (!this.options.users || !Array.isArray(this.options.users)) return [];\n      if (this.options.users.length > 100) return this.options.users.slice(0, 100);\n      return this.options.users;\n    },\n    showEmpty() {\n      return !!this.options.showEmpty;\n    },\n  },\n  data() {\n    return {\n      statuses: {},\n    };\n  },\n  methods: {\n    allowedStatuscodes() {\n      return [100, 200];\n    },\n    async fetchData() {\n      if (!this.hasValidCredentials() || !this.users.length) return;\n      await this.loadCapabilities();\n      if (!this.capabilities?.userStatus) {\n        this.error('This Nextcloud server doesn\\'t support the User Status API');\n        return;\n      }\n      if (this.fetchStrategy === fetchStrategies.allAtOnce) {\n        this.makeRequest(this.endpoint('userstatus'), this.headers)\n          .then(this.processStatuses)\n          .finally(this.finishLoading);\n      } else {\n        const promises = [];\n        this.newStatuses = {};\n        this.users.forEach((user) => {\n          promises.push(\n            this.makeRequest(`${this.endpoint('userstatus')}/${user}`, this.headers)\n              .then(this.processStatus),\n          );\n        });\n        Promise.all(promises)\n          .then(() => {\n            this.statuses = this.newStatuses;\n            delete this.newStatuses;\n          })\n          .finally(this.finishLoading);\n      }\n    },\n    processStatuses(response) {\n      const statuses = this.validateResponse(response);\n      const newStatuses = {};\n      Object.values(statuses).forEach((status) => {\n        if (!this.users.includes(status.userId)) return;\n        if (!status.message && !this.showEmpty) return;\n        newStatuses[status.userId] = status;\n      });\n      this.statuses = newStatuses;\n    },\n    processStatus(response) {\n      const raw = this.validateResponse(response);\n      const status = Array.isArray(raw) && raw.length ? raw[0] : raw;\n      if (status && (status.message || this.showEmpty)) {\n        this.newStatuses[status.userId] = status;\n      }\n    },\n    /* Tooltip generators */\n    clearAtTooltip(clearAtTime) {\n      const content = clearAtTime ? `${this.tt('until')}`\n                    + ` ${new Date(clearAtTime * 1000).toLocaleString()}` : '';\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n  },\n  created() {\n    this.overrideUpdateInterval = 60;\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '@/styles/widgets/nextcloud-shared.scss';\n.nextcloud-user-status-wrapper {\n  .status {\n    float: right;\n    i {\n      position: relative;\n      top: .15rem;\n      margin: 0;\n    }\n  }\n  .online {\n    color: var(--success);\n  }\n  .offline {\n    color: var(--medium-grey);\n  }\n  .away {\n    color: var(--error);\n  }\n  .dnd {\n    color: var(--danger);\n  }\n  div.user > div {\n    display: table;\n    width: 100%;\n    > div:first-child {\n      width: 1.75em;\n      text-align: center;\n      > i {\n        font-style: normal;\n      }\n    }\n    > div:nth-child(2) {\n      p small i {\n        top: 0;\n        opacity: .5;\n        margin: 0;\n      }\n    }\n    > div {\n      display: table-cell;\n      text-align: left;\n    }\n  }\n  div.user hr {\n    margin-top: .3em;\n    margin-bottom: .3em;\n  }\n  div.user > div > div:last-child hr {\n    margin-bottom: 0;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudUserStatus.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudUserStatus.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./NextcloudUserStatus.vue?vue&type=template&id=3edd61d2&scoped=true\"\nimport script from \"./NextcloudUserStatus.vue?vue&type=script&lang=js\"\nexport * from \"./NextcloudUserStatus.vue?vue&type=script&lang=js\"\nimport style0 from \"./NextcloudUserStatus.vue?vue&type=style&index=0&id=3edd61d2&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3edd61d2\",\n  null\n  \n)\n\nexport default component.exports","import { serviceEndpoints } from '@/utils/defaults';\nimport {\n  convertBytes, formatNumber, getTimeAgo, timestampToDateTime,\n} from '@/utils/MiscHelpers';\n\n/**\n * Reusable mixin for Nextcloud widgets\n * Nextcloud APIs\n *  - capabilities: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-api-overview.html#capabilities-api\n *  - userstatus: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-status-api.html#user-status-retrieve-statuses\n *  - user: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-api-overview.html#user-metadata\n *  - notifications: https://github.com/nextcloud/notifications/blob/master/docs/ocs-endpoint-v2.md\n *  - serverinfo: https://github.com/nextcloud/serverinfo\n */\nexport default {\n  data() {\n    return {\n      validCredentials: null,\n      capabilities: {\n        notifications: {\n          enabled: null,\n          features: [],\n        },\n        userStatus: null,\n      },\n      capabilitiesLastUpdated: 0,\n      branding: {\n        name: null,\n        logo: null,\n        url: null,\n        slogan: null,\n      },\n      version: {\n        string: null,\n        edition: null,\n      },\n    };\n  },\n  computed: {\n    /* The user provided Nextcloud hostname */\n    hostname() {\n      if (!this.options.hostname) this.error('A hostname is required');\n      return this.options.hostname;\n    },\n    /* The user provided Nextcloud username */\n    username() {\n      if (!this.options.username) this.error('A username is required');\n      return this.options.username;\n    },\n    /* The user provided Nextcloud password */\n    password() {\n      if (!this.options.password) this.error('An app-password is required');\n      // reject Nextcloud user passord (enforce 'app-password')\n      if (!/^([a-z0-9]{5}-){4}[a-z0-9]{5}$/i.test(this.options.password)) {\n        this.error('Please use a Nextcloud app-password, not your login password.');\n        return '';\n      }\n      return this.options.password;\n    },\n    /* HTTP headers for Nextcloud API requests */\n    headers() {\n      const authBase = `${this.username}:${this.password}`;\n      return {\n        'OCS-APIREQUEST': true,\n        Accept: 'application/json',\n        Authorization: `Basic ${window.btoa(authBase)}`,\n      };\n    },\n    /* TTL for data delivered by the capabilities endpoint, ms */\n    capabilitiesTtl() {\n      return (parseInt(this.options.capabilitiesTtl, 10) || 3600) * 1000;\n    },\n    proxyReqEndpoint() {\n      const baseUrl = process.env.VUE_APP_DOMAIN || window.location.origin;\n      return `${baseUrl}${serviceEndpoints.corsProxy}`;\n    },\n  },\n  methods: {\n    /* Nextcloud API endpoints */\n    endpoint(id) {\n      switch (id) {\n        case 'user':\n          return `${this.hostname}/ocs/v1.php/cloud/users/${this.username}`;\n        case 'userstatus':\n          return `${this.hostname}/ocs/v2.php/apps/user_status/api/v1/statuses`;\n        case 'serverinfo':\n          return `${this.hostname}/ocs/v2.php/apps/serverinfo/api/v1/info`;\n        case 'notifications':\n          return `${this.hostname}/ocs/v2.php/apps/notifications/api/v2/notifications`;\n        case 'capabilities':\n        default:\n          return `${this.hostname}/ocs/v1.php/cloud/capabilities`;\n      }\n    },\n    /* Helper for widgets to terminate {fetchData} early */\n    hasValidCredentials() {\n      return this.validCredentials !== false\n             && this.username.length > 0\n             && this.password.length > 0;\n    },\n    /* Primary handler for every Nextcloud API response */\n    validateResponse(response) {\n      const data = response?.ocs?.data;\n      let meta = response?.ocs?.meta;\n      const error = response?.error; // Dashy error when cors-proxied\n      if (error && error.status) {\n        meta = { statuscode: error.status };\n      }\n      if (!meta || !meta.statuscode || !data) {\n        this.error('Invalid response');\n      }\n      switch (meta.statuscode) {\n        case 401:\n          this.validCredentials = false;\n          this.error(\n            `Access denied for user ${this.username}.`\n            + ' Note that some Nextcloud widgets only work with an admin user.',\n          );\n          break;\n        case 429:\n          this.validCredentials = false;\n          this.error(\n            'The server indicated \\'rate-limit reached\\' error (HTTP 429).'\n            + ' The server-info API may return this error for incorrect user/password.',\n          );\n          break;\n        case 993:\n        case 997:\n        case 998:\n          this.validCredentials = false;\n          this.error(\n            'The provided app-password is not permitted to access the requested resource or it has'\n            + ' been revoked, or the username/password combination is incorrect',\n          );\n          break;\n        default:\n          this.validCredentials = true;\n          if (!this.allowedStatuscodes().includes(meta.statuscode)) {\n            this.error('Unexpected response');\n          }\n          break;\n      }\n      return data;\n    },\n    /* Process the capabilities endpoint if {capabilitiesTtl} has expired */\n    loadCapabilities() {\n      if ((new Date().getTime()) - this.capabilitiesLastUpdated > this.capabilitiesTtl) {\n        return this.makeRequest(this.endpoint('capabilities'), this.headers)\n          .then(this.processCapabilities);\n      }\n      return Promise.resolve();\n    },\n    /* Update the sate based on the capabilites response */\n    processCapabilities(capResponse) {\n      const ocdata = this.validateResponse(capResponse);\n      const capNotif = ocdata.capabilities?.notifications?.['ocs-endpoints'];\n      this.branding = ocdata.capabilities?.theming;\n      this.capabilities.notifications.enabled = !!(capNotif?.length);\n      this.capabilities.notifications.features = capNotif || [];\n      this.capabilities.userStatus = !!(ocdata.capabilities?.user_status?.enabled);\n      this.version.string = ocdata.version?.string;\n      this.version.edition = ocdata.version?.edition;\n      this.capabilitiesLastUpdated = new Date().getTime();\n    },\n    /* Shared template helpers */\n    getTimeAgo(time) {\n      return getTimeAgo(time);\n    },\n    formatDateTime(time) {\n      return timestampToDateTime(time);\n    },\n    /* Add additional formatting to {MiscHelpers.convertBytes()} */\n    convertBytes(bytes, decimals = 2, formatHtml = true) {\n      const formatted = convertBytes(bytes, decimals).toString();\n      if (!formatHtml) return formatted;\n      const m = formatted.match(/(-?\\d+)((\\.\\d+)?\\s(([KMGTPEZY]B|Bytes)))/);\n      return `${m[1]}<span class=\"decimals\">${m[2]}</span>`;\n    },\n    /* Add additional formatting to {MiscHelpers.formatNumber()} */\n    formatNumber(number, decimals = 1, formatHtml = true) {\n      const formatted = formatNumber(number, decimals).toString();\n      if (!formatHtml) return formatted;\n      const m = formatted.match(/(\\d+)((\\.\\d+)?([KMBT]?))/);\n      return `${m[1]}<span class=\"decimals\">${m[2]}</span>`;\n    },\n    /* Format a number as percentage value */\n    formatPercent(number, decimals = 2) {\n      const n = parseFloat(number).toFixed(decimals).split('.');\n      const d = n.length > 1 ? `.${n[1]}` : '';\n      return `${n[0]}<span class=\"decimals\">${d}%</span>`;\n    },\n    /* Similar to {MiscHelpers.getValueFromCss()} but uses the widget root node to get\n     * the computed style so widget color is respected in variable widget color themes. */\n    getValueFromCss(colorVar) {\n      const cssProps = getComputedStyle(this.$el || document.documentElement);\n      return cssProps.getPropertyValue(`--${colorVar}`).trim();\n    },\n    /* Get {colorVar} CSS property value and return as rgba() */\n    getColorRgba(colorVar, alpha = 1) {\n      const [r, g, b] = this.getValueFromCss(colorVar).match(/\\w\\w/g).map(x => parseInt(x, 16));\n      return `rgba(${r},${g},${b},${alpha})`;\n    },\n    /* Translation shorthand with key prefix */\n    tt(key, options = null) {\n      return this.$t(`widgets.nextcloud.${key}`, options);\n    },\n  },\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudUserStatus.vue?vue&type=style&index=0&id=3edd61d2&prod&scoped=true&lang=scss\""],"sourceRoot":""}