{"version":3,"sources":["webpack:///./src/mixins/WidgetMixin.js","webpack:///./src/mixins/NextcloudMixin.js","webpack:///./src/components/Charts/PercentageChart.vue?a423","webpack:///./src/components/Charts/PercentageChart.vue","webpack:///src/components/Charts/PercentageChart.vue","webpack:///./src/components/Charts/PercentageChart.vue?5eef","webpack:///./src/components/Charts/PercentageChart.vue?44f0","webpack:///./src/components/Widgets/NextcloudUser.vue?4947","webpack:///./src/components/Widgets/NextcloudUser.vue","webpack:///src/components/Widgets/NextcloudUser.vue","webpack:///./src/components/Widgets/NextcloudUser.vue?43e1","webpack:///./src/components/Widgets/NextcloudUser.vue?9590"],"names":["WidgetMixin","props","options","type","Object","default","data","progress","Progress","color","overrideProxyChoice","overrideUpdateInterval","disableLoader","updater","defaultTimeout","mounted","this","fetchData","updateInterval","continuousUpdates","beforeDestroy","clearInterval","computed","proxyReqEndpoint","baseUrl","process","VUE_APP_DOMAIN","window","location","origin","concat","serviceEndpoints","corsProxy","useProxy","usersInterval","methods","update","startLoading","_this","setInterval","error","msg","stackTrace","ErrorHandler","ignoreErrors","$emit","start","finishLoading","_this2","setTimeout","end","tooltip","content","html","arguments","length","undefined","trigger","delay","makeRequest","endpoint","protocol","body","_this3","method","url","JSON","stringify","CustomHeaders","headers","timeout","requestConfig","Promise","resolve","reject","axios","request","then","response","success","message","catch","dataFetchError","finally","validCredentials","capabilities","notifications","enabled","features","userStatus","capabilitiesLastUpdated","branding","name","logo","slogan","version","string","edition","hostname","username","password","test","authBase","Accept","Authorization","btoa","capabilitiesTtl","parseInt","id","hasValidCredentials","validateResponse","_response$ocs","_response$ocs2","ocs","meta","status","statuscode","allowedStatuscodes","includes","loadCapabilities","Date","getTime","processCapabilities","capResponse","_ocdata$capabilities","_ocdata$capabilities2","_ocdata$capabilities3","_ocdata$version","_ocdata$version2","ocdata","capNotif","theming","user_status","getTimeAgo","time","formatDateTime","timestampToDateTime","convertBytes","bytes","decimals","formatHtml","formatted","toString","m","match","formatNumber","number","formatPercent","n","parseFloat","toFixed","split","d","getValueFromCss","colorVar","cssProps","getComputedStyle","$el","document","documentElement","getPropertyValue","trim","getColorRgba","alpha","_this$getValueFromCss","map","x","_this$getValueFromCss2","_slicedToArray","r","g","b","tt","key","$t","render","_vm","_c","_self","staticClass","title","_v","_s","_e","style","makeWrapperStyles","height","_l","blocks","block","inx","directives","rawName","value","label","width","expression","makeDimens","showLegend","Math","round","makeDotColor","staticRenderFns","showAsPercent","Boolean","values","Array","String","defaultColors","startPositionSum","results","total","reduce","prev","cur","size","multiplier","forEach","index","defaultColor","push","component","didLoadData","attrs","user","displayName","lastLoginTooltip","lastLogin","quotaTooltip","quota","domProps","relative","quotaChart","dataLoaded","mixins","NextcloudMixin","components","PercentageChart","email","used","free","loadUser","processUser","userResponse","displayname","getQuotaChartColorUsed","percent","updateQuotaChart","quotaEnabled","not","classes","toLocaleString","created","updated"],"mappings":"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","file":"js/chunk-2642eaf9.a6526654.js","sourcesContent":["/**\n * Mixin that all pre-built and custom widgets extend from.\n * Manages loading state, error handling, data updates and user options\n */\nimport axios from 'axios';\nimport { Progress } from 'rsup-progress';\nimport ErrorHandler from '@/utils/ErrorHandler';\nimport { serviceEndpoints } from '@/utils/defaults';\n\nconst WidgetMixin = {\n  props: {\n    options: {\n      type: Object,\n      default: {},\n    },\n  },\n  data: () => ({\n    progress: new Progress({ color: 'var(--progress-bar)' }),\n    overrideProxyChoice: false,\n    overrideUpdateInterval: null,\n    disableLoader: false, // Prevent ever showing the loader\n    updater: null, // Stores interval\n    defaultTimeout: 50000,\n  }),\n  /* When component mounted, fetch initial data */\n  mounted() {\n    this.fetchData();\n    if (this.updateInterval) {\n      this.continuousUpdates();\n      this.disableLoader = true;\n    }\n  },\n  beforeDestroy() {\n    if (this.updater) {\n      clearInterval(this.updater);\n    }\n  },\n  computed: {\n    proxyReqEndpoint() {\n      const baseUrl = process.env.VUE_APP_DOMAIN || window.location.origin;\n      return `${baseUrl}${serviceEndpoints.corsProxy}`;\n    },\n    useProxy() {\n      return this.options.useProxy || this.overrideProxyChoice;\n    },\n    /* Returns either a number in ms to continuously update widget data. Or 0 for no updates */\n    updateInterval() {\n      const usersInterval = this.options.updateInterval;\n      if (usersInterval === null && this.overrideUpdateInterval) {\n        return this.overrideUpdateInterval * 1000;\n      }\n      if (!usersInterval) return 0;\n      // If set to `true`, then default to 30 seconds\n      if (typeof usersInterval === 'boolean') return 30 * 1000;\n      // If set to a number, and within valid range, return user choice\n      if (typeof usersInterval === 'number'\n        && usersInterval >= 2\n        && usersInterval <= 7200) {\n        return usersInterval * 1000;\n      }\n      return 0;\n    },\n  },\n  methods: {\n    /* Re-fetches external data, called by parent. Usually overridden by widget */\n    update() {\n      this.startLoading();\n      this.fetchData();\n    },\n    /* If continuous updates enabled, create interval */\n    continuousUpdates() {\n      this.updater = setInterval(() => { this.update(); }, this.updateInterval);\n    },\n    /* Called when an error occurs. Logs to handler, and passes to parent component */\n    error(msg, stackTrace) {\n      ErrorHandler(msg, stackTrace);\n      if (!this.options.ignoreErrors) {\n        this.$emit('error', msg);\n      }\n    },\n    /* When a data request update starts, show loader */\n    startLoading() {\n      if (!this.disableLoader) {\n        this.$emit('loading', true);\n        this.progress.start();\n      }\n    },\n    /* When a data request finishes, hide loader */\n    finishLoading() {\n      this.$emit('loading', false);\n      setTimeout(() => { this.progress.end(); }, 500);\n    },\n    /* Overridden by child component. Will make network request, then end loader */\n    fetchData() {\n      this.finishLoading();\n    },\n    /* Used as v-tooltip, pass text content in, and will show on hover */\n    tooltip(content, html = false) {\n      return {\n        content, html, trigger: 'hover focus', delay: 250,\n      };\n    },\n    /* Makes data request, returns promise */\n    makeRequest(endpoint, options, protocol, body) {\n      // Request Options\n      const method = protocol || 'GET';\n      const url = this.useProxy ? this.proxyReqEndpoint : endpoint;\n      const data = JSON.stringify(body || {});\n      const CustomHeaders = options || null;\n      const headers = this.useProxy\n        ? { 'Target-URL': endpoint, CustomHeaders: JSON.stringify(CustomHeaders) } : CustomHeaders;\n      const timeout = this.options.timeout || this.defaultTimeout;\n      const requestConfig = {\n        method, url, headers, data, timeout,\n      };\n      // Make request\n      return new Promise((resolve, reject) => {\n        axios.request(requestConfig)\n          .then((response) => {\n            if (response.data.success === false) {\n              this.error('Proxy returned error from target server', response.data.message);\n            }\n            resolve(response.data);\n          })\n          .catch((dataFetchError) => {\n            this.error('Unable to fetch data', dataFetchError);\n            reject(dataFetchError);\n          })\n          .finally(() => {\n            this.finishLoading();\n          });\n      });\n    },\n  },\n};\n\nexport default WidgetMixin;\n","import { serviceEndpoints } from '@/utils/defaults';\nimport {\n  convertBytes, formatNumber, getTimeAgo, timestampToDateTime,\n} from '@/utils/MiscHelpers';\n\n/**\n * Reusable mixin for Nextcloud widgets\n * Nextcloud APIs\n *  - capabilities: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-api-overview.html#capabilities-api\n *  - userstatus: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-status-api.html#user-status-retrieve-statuses\n *  - user: https://docs.nextcloud.com/server/latest/developer_manual/client_apis/OCS/ocs-api-overview.html#user-metadata\n *  - notifications: https://github.com/nextcloud/notifications/blob/master/docs/ocs-endpoint-v2.md\n *  - serverinfo: https://github.com/nextcloud/serverinfo\n */\nexport default {\n  data() {\n    return {\n      validCredentials: null,\n      capabilities: {\n        notifications: {\n          enabled: null,\n          features: [],\n        },\n        userStatus: null,\n      },\n      capabilitiesLastUpdated: 0,\n      branding: {\n        name: null,\n        logo: null,\n        url: null,\n        slogan: null,\n      },\n      version: {\n        string: null,\n        edition: null,\n      },\n    };\n  },\n  computed: {\n    /* The user provided Nextcloud hostname */\n    hostname() {\n      if (!this.options.hostname) this.error('A hostname is required');\n      return this.options.hostname;\n    },\n    /* The user provided Nextcloud username */\n    username() {\n      if (!this.options.username) this.error('A username is required');\n      return this.options.username;\n    },\n    /* The user provided Nextcloud password */\n    password() {\n      if (!this.options.password) this.error('An app-password is required');\n      // reject Nextcloud user passord (enforce 'app-password')\n      if (!/^([a-z0-9]{5}-){4}[a-z0-9]{5}$/i.test(this.options.password)) {\n        this.error('Please use a Nextcloud app-password, not your login password.');\n        return '';\n      }\n      return this.options.password;\n    },\n    /* HTTP headers for Nextcloud API requests */\n    headers() {\n      const authBase = `${this.username}:${this.password}`;\n      return {\n        'OCS-APIREQUEST': true,\n        Accept: 'application/json',\n        Authorization: `Basic ${window.btoa(authBase)}`,\n      };\n    },\n    /* TTL for data delivered by the capabilities endpoint, ms */\n    capabilitiesTtl() {\n      return (parseInt(this.options.capabilitiesTtl, 10) || 3600) * 1000;\n    },\n    proxyReqEndpoint() {\n      const baseUrl = process.env.VUE_APP_DOMAIN || window.location.origin;\n      return `${baseUrl}${serviceEndpoints.corsProxy}`;\n    },\n  },\n  methods: {\n    /* Nextcloud API endpoints */\n    endpoint(id) {\n      switch (id) {\n        case 'user':\n          return `${this.hostname}/ocs/v1.php/cloud/users/${this.username}`;\n        case 'userstatus':\n          return `${this.hostname}/ocs/v2.php/apps/user_status/api/v1/statuses`;\n        case 'serverinfo':\n          return `${this.hostname}/ocs/v2.php/apps/serverinfo/api/v1/info`;\n        case 'notifications':\n          return `${this.hostname}/ocs/v2.php/apps/notifications/api/v2/notifications`;\n        case 'capabilities':\n        default:\n          return `${this.hostname}/ocs/v1.php/cloud/capabilities`;\n      }\n    },\n    /* Helper for widgets to terminate {fetchData} early */\n    hasValidCredentials() {\n      return this.validCredentials !== false\n             && this.username.length > 0\n             && this.password.length > 0;\n    },\n    /* Primary handler for every Nextcloud API response */\n    validateResponse(response) {\n      const data = response?.ocs?.data;\n      let meta = response?.ocs?.meta;\n      const error = response?.error; // Dashy error when cors-proxied\n      if (error && error.status) {\n        meta = { statuscode: error.status };\n      }\n      if (!meta || !meta.statuscode || !data) {\n        this.error('Invalid response');\n      }\n      switch (meta.statuscode) {\n        case 401:\n          this.validCredentials = false;\n          this.error(\n            `Access denied for user ${this.username}.`\n            + ' Note that some Nextcloud widgets only work with an admin user.',\n          );\n          break;\n        case 429:\n          this.validCredentials = false;\n          this.error(\n            'The server indicated \\'rate-limit reached\\' error (HTTP 429).'\n            + ' The server-info API may return this error for incorrect user/password.',\n          );\n          break;\n        case 993:\n        case 997:\n        case 998:\n          this.validCredentials = false;\n          this.error(\n            'The provided app-password is not permitted to access the requested resource or it has'\n            + ' been revoked, or the username/password combination is incorrect',\n          );\n          break;\n        default:\n          this.validCredentials = true;\n          if (!this.allowedStatuscodes().includes(meta.statuscode)) {\n            this.error('Unexpected response');\n          }\n          break;\n      }\n      return data;\n    },\n    /* Process the capabilities endpoint if {capabilitiesTtl} has expired */\n    loadCapabilities() {\n      if ((new Date().getTime()) - this.capabilitiesLastUpdated > this.capabilitiesTtl) {\n        return this.makeRequest(this.endpoint('capabilities'), this.headers)\n          .then(this.processCapabilities);\n      }\n      return Promise.resolve();\n    },\n    /* Update the sate based on the capabilites response */\n    processCapabilities(capResponse) {\n      const ocdata = this.validateResponse(capResponse);\n      const capNotif = ocdata.capabilities?.notifications?.['ocs-endpoints'];\n      this.branding = ocdata.capabilities?.theming;\n      this.capabilities.notifications.enabled = !!(capNotif?.length);\n      this.capabilities.notifications.features = capNotif || [];\n      this.capabilities.userStatus = !!(ocdata.capabilities?.user_status?.enabled);\n      this.version.string = ocdata.version?.string;\n      this.version.edition = ocdata.version?.edition;\n      this.capabilitiesLastUpdated = new Date().getTime();\n    },\n    /* Shared template helpers */\n    getTimeAgo(time) {\n      return getTimeAgo(time);\n    },\n    formatDateTime(time) {\n      return timestampToDateTime(time);\n    },\n    /* Add additional formatting to {MiscHelpers.convertBytes()} */\n    convertBytes(bytes, decimals = 2, formatHtml = true) {\n      const formatted = convertBytes(bytes, decimals).toString();\n      if (!formatHtml) return formatted;\n      const m = formatted.match(/(-?\\d+)((\\.\\d+)?\\s(([KMGTPEZY]B|Bytes)))/);\n      return `${m[1]}<span class=\"decimals\">${m[2]}</span>`;\n    },\n    /* Add additional formatting to {MiscHelpers.formatNumber()} */\n    formatNumber(number, decimals = 1, formatHtml = true) {\n      const formatted = formatNumber(number, decimals).toString();\n      if (!formatHtml) return formatted;\n      const m = formatted.match(/(\\d+)((\\.\\d+)?([KMBT]?))/);\n      return `${m[1]}<span class=\"decimals\">${m[2]}</span>`;\n    },\n    /* Format a number as percentage value */\n    formatPercent(number, decimals = 2) {\n      const n = parseFloat(number).toFixed(decimals).split('.');\n      const d = n.length > 1 ? `.${n[1]}` : '';\n      return `${n[0]}<span class=\"decimals\">${d}%</span>`;\n    },\n    /* Similar to {MiscHelpers.getValueFromCss()} but uses the widget root node to get\n     * the computed style so widget color is respected in variable widget color themes. */\n    getValueFromCss(colorVar) {\n      const cssProps = getComputedStyle(this.$el || document.documentElement);\n      return cssProps.getPropertyValue(`--${colorVar}`).trim();\n    },\n    /* Get {colorVar} CSS property value and return as rgba() */\n    getColorRgba(colorVar, alpha = 1) {\n      const [r, g, b] = this.getValueFromCss(colorVar).match(/\\w\\w/g).map(x => parseInt(x, 16));\n      return `rgba(${r},${g},${b},${alpha})`;\n    },\n    /* Translation shorthand with key prefix */\n    tt(key, options = null) {\n      return this.$t(`widgets.nextcloud.${key}`, options);\n    },\n  },\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PercentageChart.vue?vue&type=style&index=0&id=b3e246fa&prod&scoped=true&lang=scss\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"percentage-chart-wrapper\"},[(_vm.title)?_c('div',{staticClass:\"title\"},[_c('p',[_vm._v(_vm._s(_vm.title))])]):_vm._e(),_c('div',{staticClass:\"percentage-chart\",style:(_vm.makeWrapperStyles(_vm.height))},_vm._l((_vm.blocks),function(block,inx){return _c('div',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(`${block.label} - ${block.width}%`),expression:\"`${block.label} - ${block.width}%`\"}],key:inx,staticClass:\"inner\",style:(_vm.makeDimens(block))})}),0),(_vm.showLegend)?_c('div',{staticClass:\"legend\"},_vm._l((_vm.blocks),function(block,inx){return _c('div',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(`${Math.round(block.width)}% (${block.value})`),expression:\"`${Math.round(block.width)}% (${block.value})`\"}],key:inx,staticClass:\"legend-item\"},[(block.label)?_c('div',{staticClass:\"dot\",style:(_vm.makeDotColor(block))}):_vm._e(),(block.label)?_c('div',{staticClass:\"txt\"},[_vm._v(_vm._s(block.label))]):_vm._e()])}),0):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"percentage-chart-wrapper\">\n  <!-- Chart Heading -->\n  <div class=\"title\" v-if=\"title\">\n    <p>{{ title }}</p>\n  </div>\n  <!-- Percentage Chart -->\n  <div class=\"percentage-chart\" :style=\"makeWrapperStyles(height)\">\n    <div\n      v-for=\"(block, inx) in blocks\" :key=\"inx\"\n      class=\"inner\" :style=\"makeDimens(block)\"\n      v-tooltip=\"`${block.label} - ${block.width}%`\"\n    ></div>\n  </div>\n  <!-- Chart Legend / Key -->\n  <div class=\"legend\" v-if=\"showLegend\">\n    <div v-for=\"(block, inx) in blocks\" :key=\"inx\"\n      class=\"legend-item\" v-tooltip=\"`${Math.round(block.width)}% (${block.value})`\">\n      <div class=\"dot\" v-if=\"block.label\" :style=\"makeDotColor(block)\"></div>\n      <div class=\"txt\" v-if=\"block.label\">{{ block.label }}</div>\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\n\nexport default {\n  props: {\n    showAsPercent: {\n      type: Boolean,\n      default: true,\n    },\n    showLegend: {\n      type: Boolean,\n      default: true,\n    },\n    height: {\n      number: Boolean,\n      default: 1,\n    },\n    values: Array,\n    title: String,\n  },\n  data() {\n    return {\n      defaultColors: [\n        '#eb5cad', '#985ceb', '#5346f3', '#5c90eb', '#5cdfeb',\n        '#00CCB4', '#5ceb8d', '#afeb5c', '#eff961',\n      ],\n    };\n  },\n  computed: {\n    blocks() {\n      let startPositionSum = 0;\n      const results = [];\n      const total = this.values.reduce((prev, cur) => (prev.size || prev) + cur.size);\n      const multiplier = this.showAsPercent ? 100 / total : 1;\n      this.values.forEach((value, index) => {\n        const defaultColor = this.defaultColors[index % this.defaultColors.length];\n        results.push({\n          start: startPositionSum,\n          width: Math.round(value.size * multiplier),\n          color: value.color || defaultColor,\n          label: value.label,\n          value: value.size,\n        });\n        startPositionSum += (value.size * multiplier);\n      });\n      return results;\n    },\n  },\n  methods: {\n    makeDimens(block) {\n      return `margin-left: ${block.start}%; width: ${block.width}%; background: ${block.color}`;\n    },\n    makeDotColor(block) {\n      return `background: ${block.color};`;\n    },\n    makeWrapperStyles(height) {\n      return `height: ${height}rem`;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.percentage-chart-wrapper {\n  // Chart Title\n  .title {\n    p {\n      font-size: 1rem;\n      margin: 0.5rem 0;\n      color: var(--widget-text-color);\n      opacity: var(--dimming-factor);\n    }\n  }\n  // Main Chart\n  .percentage-chart {\n    width: 100%;\n    background: grey;\n    position: relative;\n    height: 2rem;\n    margin: 0.5rem auto;\n    border-radius: 3px;\n    overflow: hidden;\n    .inner {\n      position: absolute;\n      width: 30%;\n      height: 100%;\n      box-shadow: inset 0px -1px 2px #000000bf;\n      &:hover {\n        box-shadow: inset 0px -1px 4px #000000bf;\n      }\n    }\n  }\n  // Chart Legend\n  .legend {\n    display: flex;\n    margin-top: 0.5rem;\n    .legend-item {\n      display: flex;\n      align-items: center;\n      .dot {\n        width: 1rem;\n        height: 1rem;\n        border-radius: 1rem;\n      }\n      .txt {\n        font-size: 0.8rem;\n        margin: 0.5rem;\n        color: var(--widget-text-color);\n        opacity: var(--dimming-factor);\n      }\n      &:hover {\n        .txt { opacity: 1; }\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PercentageChart.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PercentageChart.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./PercentageChart.vue?vue&type=template&id=b3e246fa&scoped=true\"\nimport script from \"./PercentageChart.vue?vue&type=script&lang=js\"\nexport * from \"./PercentageChart.vue?vue&type=script&lang=js\"\nimport style0 from \"./PercentageChart.vue?vue&type=style&index=0&id=b3e246fa&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b3e246fa\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudUser.vue?vue&type=style&index=0&id=bb4eef48&prod&scoped=true&lang=scss\"","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.didLoadData)?_c('div',{staticClass:\"nextcloud-widget nextcloud-info-wrapper\"},[_c('div',[_c('div',{staticClass:\"logo\"},[_c('a',{attrs:{\"href\":_vm.branding.url,\"target\":\"_blank\"}},[_c('img',{attrs:{\"src\":_vm.branding.logo}})]),_c('p',[_vm._v(_vm._s(_vm.branding.slogan))])]),_c('div',{staticClass:\"info\"},[_c('p',{staticClass:\"brand\"},[_vm._v(_vm._s(_vm.branding.name))]),(_vm.version.string)?_c('p',{staticClass:\"version\"},[_c('small',[_vm._v(\"Nextcloud \"+_vm._s(_vm.tt('version'))+\" \"+_vm._s(_vm.version.string))])]):_vm._e(),_c('p',{staticClass:\"username\"},[_vm._v(_vm._s(_vm.user.displayName)+\" \"),_c('em',[_vm._v(\"(\"+_vm._s(_vm.user.id)+\")\")])]),_c('p',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.lastLoginTooltip()),expression:\"lastLoginTooltip()\"}],staticClass:\"login\"},[_c('span',[_vm._v(_vm._s(_vm.tt('last-login')))]),_vm._v(\"  \"),_c('small',[_vm._v(_vm._s(_vm.getTimeAgo(_vm.user.lastLogin)))])])])]),_c('div',[_c('div',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.quotaTooltip()),expression:\"quotaTooltip()\"}]},[_c('hr'),_c('p',[_c('i',{staticClass:\"fal fa-disc-drive\"}),(_vm.user.quota.quota > 0)?_c('strong',[_vm._v(_vm._s(_vm.tt('disk-quota')))]):_c('strong',[_vm._v(_vm._s(_vm.tt('disk-space')))]),_c('em',{domProps:{\"innerHTML\":_vm._s(_vm.formatPercent(_vm.user.quota.relative))}}),_c('small',[_vm._v(_vm._s(_vm.tt('of')))]),_c('strong',{domProps:{\"innerHTML\":_vm._s(_vm.convertBytes(_vm.user.quota.total))}}),(_vm.quotaChart.dataLoaded)?_c('span',[_c('PercentageChart',{attrs:{\"values\":_vm.quotaChart.data,\"showLegend\":false}})],1):_vm._e()]),_c('hr')])])]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div v-if=\"didLoadData\" class=\"nextcloud-widget nextcloud-info-wrapper\">\n  <!-- logo, branding, user info -->\n  <div>\n    <div class=\"logo\">\n      <a :href=\"branding.url\" target=\"_blank\">\n        <img :src=\"branding.logo\" />\n      </a>\n      <p>{{ branding.slogan }}</p>\n    </div>\n    <div class=\"info\">\n      <p class=\"brand\">{{ branding.name }}</p>\n      <p class=\"version\" v-if=\"version.string\">\n        <small>Nextcloud {{ tt('version') }} {{ version.string }}</small>\n      </p>\n      <p class=\"username\">{{ user.displayName }} <em>({{ user.id }})</em></p>\n      <p class=\"login\" v-tooltip=\"lastLoginTooltip()\">\n        <span>{{ tt('last-login') }}</span>&nbsp;\n        <small>{{ getTimeAgo(user.lastLogin) }}</small>\n      </p>\n    </div>\n  </div>\n  <!-- disk space/quota -->\n  <div>\n    <div v-tooltip=\"quotaTooltip()\">\n      <hr/>\n      <p>\n        <i class=\"fal fa-disc-drive\"></i>\n        <strong v-if=\"user.quota.quota > 0\">{{ tt('disk-quota') }}</strong>\n        <strong v-else>{{ tt('disk-space') }}</strong>\n        <em v-html=\"formatPercent(user.quota.relative)\"></em>\n        <small>{{ tt('of') }}</small><strong v-html=\"convertBytes(user.quota.total)\"></strong>\n        <span v-if=\"quotaChart.dataLoaded\">\n          <PercentageChart :values=\"quotaChart.data\" :showLegend=\"false\" />\n        </span>\n      </p>\n      <hr/>\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport WidgetMixin from '@/mixins/WidgetMixin';\nimport NextcloudMixin from '@/mixins/NextcloudMixin';\nimport PercentageChart from '@/components/Charts/PercentageChart';\n\n/**\n * NextcloudUser widget - Displays branding and user information\n * Used endpoints\n *  - capabilities: this delivers branding info (server name, logo, slogan, etc.)\n *  - user: name, last login, disk quota info\n */\nexport default {\n  mixins: [WidgetMixin, NextcloudMixin],\n  components: { PercentageChart },\n  data() {\n    return {\n      user: {\n        id: null,\n        displayName: null,\n        email: null,\n        quota: {\n          relative: null,\n          total: null,\n          used: null,\n          free: null,\n          quota: null,\n        },\n      },\n      quotaChart: {\n        dataLoaded: false,\n        data: [\n          { label: null, size: null, color: null },\n          { label: null, size: null, color: null },\n        ],\n      },\n    };\n  },\n  computed: {\n    didLoadData() {\n      return !!this.user.id;\n    },\n  },\n  methods: {\n    allowedStatuscodes() {\n      return [100, 200];\n    },\n    fetchData() {\n      if (!this.hasValidCredentials()) return;\n      this.loadCapabilities()\n        .then(this.loadUser)\n        .finally(this.finishLoading);\n    },\n    loadUser() {\n      return this.makeRequest(this.endpoint('user'), this.headers)\n        .then(this.processUser);\n    },\n    processUser(userResponse) {\n      const user = this.validateResponse(userResponse);\n      this.user.id = user.id;\n      this.user.email = user.email;\n      this.user.quota = user.quota;\n      this.user.displayName = user.displayname;\n      this.user.lastLogin = user.lastLogin;\n    },\n    getQuotaChartColorUsed(percent) {\n      if (percent < 0.75) return this.getValueFromCss('widget-text-color');\n      if (percent < 0.85) return this.getValueFromCss('warning');\n      if (percent < 0.95) return this.getValueFromCss('error');\n      return this.getValueFromCss('danger');\n    },\n    updateQuotaChart() {\n      const used = parseFloat(this.user.quota.used / this.user.quota.total);\n      const free = parseFloat(this.user.quota.free / this.user.quota.total);\n      const d = this.quotaChart.data;\n      d[0] = { label: this.tt('used'), size: used, color: this.getQuotaChartColorUsed(used) };\n      d[1] = { label: this.tt('available'), size: free, color: this.getValueFromCss('success') };\n      this.quotaChart.dataLoaded = true;\n    },\n    /* Tooltip generators */\n    quotaTooltip() {\n      const quotaEnabled = this.user.quota.quota > 0;\n      const content = `${this.tt('quota-enabled', { not: quotaEnabled ? '' : 'not ' })}`\n                    + `<br><br>${this.convertBytes(this.user.quota.used)} ${this.tt('used')}<br>`\n                    + `${this.convertBytes(this.user.quota.free)} ${this.tt('free')}<br>`\n                    + `${this.convertBytes(this.user.quota.total)} ${this.tt('total')}`;\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n    lastLoginTooltip() {\n      const content = new Date(this.user.lastLogin).toLocaleString();\n      return {\n        content, html: true, trigger: 'hover focus', delay: 250, classes: 'nc-tooltip',\n      };\n    },\n  },\n  created() {\n    this.overrideUpdateInterval = 120;\n  },\n  updated() {\n    this.updateQuotaChart();\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '@/styles/widgets/nextcloud-shared.scss';\n.nextcloud-info-wrapper {\n  > div:first-child {\n    display: flex;\n  }\n  > div:nth-child(2) {\n    border-top: none;\n  }\n  div.percentage-chart-wrapper {\n    margin: 0 .75em;\n    width: 5em;\n    position: relative;\n    top: .2em;\n    float: right;\n  }\n  div.logo {\n    width: 40%;\n    text-align: center;\n    img {\n      width: 8em;\n    }\n    p {\n      font-size: .9em;\n      opacity: .85;\n    }\n  }\n  div.info {\n    width: 56%;\n    p {\n      margin: 0 0 1rem 0;\n    }\n    p:last-child {\n      margin: 0;\n    }\n    p.brand {\n      margin: 0;\n      font-size: 1.35em;\n      font-weight: 800;\n      letter-spacing: 3px;\n    }\n    p.version small {\n      font-size: .75em;\n    }\n    p.username {\n      font-size: 1.1em;\n      em {\n        font-size: .9em;\n      }\n    }\n    p.login {\n      span {\n        font-size: .9em;\n        margin-right: .25em;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudUser.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NextcloudUser.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./NextcloudUser.vue?vue&type=template&id=bb4eef48&scoped=true\"\nimport script from \"./NextcloudUser.vue?vue&type=script&lang=js\"\nexport * from \"./NextcloudUser.vue?vue&type=script&lang=js\"\nimport style0 from \"./NextcloudUser.vue?vue&type=style&index=0&id=bb4eef48&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bb4eef48\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}