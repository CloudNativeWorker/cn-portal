(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-468d3a74"],{"06c8":function(t,e,s){"use strict";s("0dbc")},"0dbc":function(t,e,s){},"1c8e":function(t,e,s){"use strict";s("99af"),s("e9c4"),s("d3b7");var o=s("cee4"),a=s("d445"),i=s("3136"),n=s("5cc6"),r={props:{options:{type:Object,default:{}}},data:function(){return{progress:new a["a"]({color:"var(--progress-bar)"}),overrideProxyChoice:!1,overrideUpdateInterval:null,disableLoader:!1,updater:null,defaultTimeout:5e4}},mounted:function(){this.fetchData(),this.updateInterval&&(this.continuousUpdates(),this.disableLoader=!0)},beforeDestroy:function(){this.updater&&clearInterval(this.updater)},computed:{proxyReqEndpoint:function(){var t=Object({NODE_ENV:"production",VUE_APP_VERSION:"2.1.2",BASE_URL:"/"}).VUE_APP_DOMAIN||window.location.origin;return"".concat(t).concat(n["serviceEndpoints"].corsProxy)},useProxy:function(){return this.options.useProxy||this.overrideProxyChoice},updateInterval:function(){var t=this.options.updateInterval;return null===t&&this.overrideUpdateInterval?1e3*this.overrideUpdateInterval:t?"boolean"===typeof t?3e4:"number"===typeof t&&t>=2&&t<=7200?1e3*t:0:0}},methods:{update:function(){this.startLoading(),this.fetchData()},continuousUpdates:function(){var t=this;this.updater=setInterval((function(){t.update()}),this.updateInterval)},error:function(t,e){Object(i["e"])(t,e),this.options.ignoreErrors||this.$emit("error",t)},startLoading:function(){this.disableLoader||(this.$emit("loading",!0),this.progress.start())},finishLoading:function(){var t=this;this.$emit("loading",!1),setTimeout((function(){t.progress.end()}),500)},fetchData:function(){this.finishLoading()},tooltip:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{content:t,html:e,trigger:"hover focus",delay:250}},makeRequest:function(t,e,s,a){var i=this,n=s||"GET",r=this.useProxy?this.proxyReqEndpoint:t,c=JSON.stringify(a||{}),l=e||null,h=this.useProxy?{"Target-URL":t,CustomHeaders:JSON.stringify(l)}:l,u=this.options.timeout||this.defaultTimeout,d={method:n,url:r,headers:h,data:c,timeout:u};return new Promise((function(t,e){o["a"].request(d).then((function(e){!1===e.data.success&&i.error("Proxy returned error from target server",e.data.message),t(e.data)})).catch((function(t){i.error("Unable to fetch data",t),e(t)})).finally((function(){i.finishLoading()}))}))}}};e["a"]=r},"2c3a":function(t,e,s){"use strict";var o=s("3835"),a=(s("99af"),s("caad"),s("d81d"),s("b680"),s("d3b7"),s("ac1f"),s("00b4"),s("25f0"),s("2532"),s("466d"),s("498a"),s("313d"),s("0eb6"),s("b7ef"),s("8bd4"),s("5cc6")),i=s("b96f");e["a"]={data:function(){return{validCredentials:null,capabilities:{notifications:{enabled:null,features:[]},userStatus:null},capabilitiesLastUpdated:0,branding:{name:null,logo:null,url:null,slogan:null},version:{string:null,edition:null}}},computed:{hostname:function(){return this.options.hostname||this.error("A hostname is required"),this.options.hostname},username:function(){return this.options.username||this.error("A username is required"),this.options.username},password:function(){return this.options.password||this.error("An app-password is required"),/^([a-z0-9]{5}-){4}[a-z0-9]{5}$/i.test(this.options.password)?this.options.password:(this.error("Please use a Nextcloud app-password, not your login password."),"")},headers:function(){var t="".concat(this.username,":").concat(this.password);return{"OCS-APIREQUEST":!0,Accept:"application/json",Authorization:"Basic ".concat(window.btoa(t))}},capabilitiesTtl:function(){return 1e3*(parseInt(this.options.capabilitiesTtl,10)||3600)},proxyReqEndpoint:function(){var t=Object({NODE_ENV:"production",VUE_APP_VERSION:"2.1.2",BASE_URL:"/"}).VUE_APP_DOMAIN||window.location.origin;return"".concat(t).concat(a["serviceEndpoints"].corsProxy)}},methods:{endpoint:function(t){switch(t){case"user":return"".concat(this.hostname,"/ocs/v1.php/cloud/users/").concat(this.username);case"userstatus":return"".concat(this.hostname,"/ocs/v2.php/apps/user_status/api/v1/statuses");case"serverinfo":return"".concat(this.hostname,"/ocs/v2.php/apps/serverinfo/api/v1/info");case"notifications":return"".concat(this.hostname,"/ocs/v2.php/apps/notifications/api/v2/notifications");case"capabilities":default:return"".concat(this.hostname,"/ocs/v1.php/cloud/capabilities")}},hasValidCredentials:function(){return!1!==this.validCredentials&&this.username.length>0&&this.password.length>0},validateResponse:function(t){var e,s,o=null===t||void 0===t||null===(e=t.ocs)||void 0===e?void 0:e.data,a=null===t||void 0===t||null===(s=t.ocs)||void 0===s?void 0:s.meta,i=null===t||void 0===t?void 0:t.error;switch(i&&i.status&&(a={statuscode:i.status}),a&&a.statuscode&&o||this.error("Invalid response"),a.statuscode){case 401:this.validCredentials=!1,this.error("Access denied for user ".concat(this.username,".")+" Note that some Nextcloud widgets only work with an admin user.");break;case 429:this.validCredentials=!1,this.error("The server indicated 'rate-limit reached' error (HTTP 429). The server-info API may return this error for incorrect user/password.");break;case 993:case 997:case 998:this.validCredentials=!1,this.error("The provided app-password is not permitted to access the requested resource or it has been revoked, or the username/password combination is incorrect");break;default:this.validCredentials=!0,this.allowedStatuscodes().includes(a.statuscode)||this.error("Unexpected response");break}return o},loadCapabilities:function(){return(new Date).getTime()-this.capabilitiesLastUpdated>this.capabilitiesTtl?this.makeRequest(this.endpoint("capabilities"),this.headers).then(this.processCapabilities):Promise.resolve()},processCapabilities:function(t){var e,s,o,a,i,n=this.validateResponse(t),r=null===(e=n.capabilities)||void 0===e||null===(e=e.notifications)||void 0===e?void 0:e["ocs-endpoints"];this.branding=null===(s=n.capabilities)||void 0===s?void 0:s.theming,this.capabilities.notifications.enabled=!(null===r||void 0===r||!r.length),this.capabilities.notifications.features=r||[],this.capabilities.userStatus=!(null===(o=n.capabilities)||void 0===o||null===(o=o.user_status)||void 0===o||!o.enabled),this.version.string=null===(a=n.version)||void 0===a?void 0:a.string,this.version.edition=null===(i=n.version)||void 0===i?void 0:i.edition,this.capabilitiesLastUpdated=(new Date).getTime()},getTimeAgo:function(t){return Object(i["l"])(t)},formatDateTime:function(t){return Object(i["s"])(t)},convertBytes:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Object(i["d"])(t,e).toString();if(!s)return o;var a=o.match(/(-?\d+)((\.\d+)?\s(([KMGTPEZY]B|Bytes)))/);return"".concat(a[1],'<span class="decimals">').concat(a[2],"</span>")},formatNumber:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Object(i["g"])(t,e).toString();if(!s)return o;var a=o.match(/(\d+)((\.\d+)?([KMBT]?))/);return"".concat(a[1],'<span class="decimals">').concat(a[2],"</span>")},formatPercent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,s=parseFloat(t).toFixed(e).split("."),o=s.length>1?".".concat(s[1]):"";return"".concat(s[0],'<span class="decimals">').concat(o,"%</span>")},getValueFromCss:function(t){var e=getComputedStyle(this.$el||document.documentElement);return e.getPropertyValue("--".concat(t)).trim()},getColorRgba:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=this.getValueFromCss(t).match(/\w\w/g).map((function(t){return parseInt(t,16)})),a=Object(o["a"])(s,3),i=a[0],n=a[1],r=a[2];return"rgba(".concat(i,",").concat(n,",").concat(r,",").concat(e,")")},tt:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.$t("widgets.nextcloud.".concat(t),e)}}}},"8eac":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;return t.didLoadData?e("div",{staticClass:"nextcloud-widget nextcloud-phpopcache-wrapper"},[e("div",{staticClass:"sep"},[e("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.opcacheStartTimeTooltip(),expression:"opcacheStartTimeTooltip()"}]},[e("i",{staticClass:"fal fa-microchip"}),e("strong",[t._v("PHP opcache")]),t._v("  "),t.opcache.opcache_enabled?e("em",{staticClass:"oc-enabled"},[t._v(" "+t._s(t.tt("enabled"))+" ")]):e("em",{staticClass:"oc-disabled"},[t._v(t._s(t.tt("disabled")))]),t._v("  "),t.opcache.cache_full?e("strong",{staticClass:"oc-full"},[e("i",{staticClass:"far fa-siren-on"}),t._v(t._s(t.tt("cache-full"))+" ")]):t._e()]),e("hr"),t.opcache.opcache_enabled?e("div",[e("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.opcacheStatsTooltip(),expression:"opcacheStatsTooltip()"}]},[e("i",{staticClass:"fal fa-bullseye-arrow"}),e("em",{domProps:{innerHTML:t._s(t.formatNumber(t.opcache_stats.hits))}}),t._v("  "),e("small",[t._v(t._s(t.tt("hits")))]),t._v("  "),e("em",{domProps:{innerHTML:t._s(t.formatNumber(t.opcache_stats.misses))}}),t._v("  "),e("small",[t._v(t._s(t.tt("misses")))]),t._v("  "),e("em",{domProps:{innerHTML:t._s(t.formatPercent(t.opcache_stats.opcache_hit_rate,3))}}),t._v("  "),e("small",[t._v(t._s(t.tt("hit-rate")))])]),e("hr"),e("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.opcacheMemoryUsageTooltip(),expression:"opcacheMemoryUsageTooltip()"}]},[e("i",{staticClass:"fal fa-memory"}),e("em",{domProps:{innerHTML:t._s(t.formatPercent(t.opcache.memory_usage.used_memory_percentage,1))}}),t._v("  "),e("small",[t._v("of")]),e("em",{domProps:{innerHTML:t._s(t.convertBytes(t.opcache.memory_usage.total_memory))}}),t._v("  "),e("small",[t._v(t._s(t.tt("memory-used")))])]),e("hr"),e("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.opcacheInternedStringsTooltip(),expression:"opcacheInternedStringsTooltip()"}]},[e("i",{staticClass:"fal fa-puzzle-piece"}),e("em",{domProps:{innerHTML:t._s(t.formatNumber(t.opcache.interned_strings_usage.number_of_strings,1,!0))}}),t._v("  "),e("small",[t._v(t._s(t.tt("strings-use")))]),e("em",{domProps:{innerHTML:t._s(t.formatPercent(t.opcache.interned_strings_usage.used_memory_percentage))}}),t._v("  "),e("small",[t._v(t._s(t.tt("of")))]),e("em",{domProps:{innerHTML:t._s(t.convertBytes(t.opcache.interned_strings_usage.total_memory))}})]),e("hr")]):t._e()])]):t._e()},a=[],i=(s("99af"),s("b680"),s("d3b7"),s("1c8e")),n=s("2c3a"),r={mixins:[i["a"],n["a"]],components:{},data:function(){return{opcache:{opcache_enabled:null,full:null,opcache_statistics:{num_cached_scripts:null,num_cached_keys:null,max_cached_keys:null,hits:null,start_time:null,last_restart_time:null,misses:null,opcache_hit_rate:null},memory_usage:{used_memory:null,free_memory:null,total_memory:null,wasted_memory:null,used_memory_percentage:null,current_wasted_percentage:null},interned_strings_usage:{buffer_size:null,used_memory:null,total_memory:null,free_memory:null,number_of_strings:null,used_memory_percentage:null}}}},computed:{didLoadData:function(){var t;return"boolean"===typeof(null===this||void 0===this||null===(t=this.opcache)||void 0===t?void 0:t.opcache_enabled)},opcache_stats:function(){return this.opcache.opcache_statistics},opcache_interned:function(){return this.opcache.interned_strings_usage}},methods:{allowedStatuscodes:function(){return[200]},fetchData:function(){var t=this;this.hasValidCredentials()&&this.makeRequest(this.endpoint("serverinfo"),this.headers).then(this.processServerInfo).finally((function(){return t.finishLoading()}))},processServerInfo:function(t){var e,s=this.validateResponse(t);this.opcache=null===(e=s.server)||void 0===e||null===(e=e.php)||void 0===e?void 0:e.opcache,this.opcache&&(this.updateOpcacheMemory(),this.updateOpcacheInterned())},updateOpcacheMemory:function(){this.opcache_stats.opcache_hit_rate=parseFloat(this.opcache_stats.opcache_hit_rate).toFixed(3),this.opcache.memory_usage.total_memory=this.opcache.memory_usage.used_memory+this.opcache.memory_usage.free_memory,this.opcache.memory_usage.used_memory_percentage=parseFloat(this.opcache.memory_usage.used_memory/this.opcache.memory_usage.total_memory*100).toFixed(1)},updateOpcacheInterned:function(){this.opcache_interned.total_memory=this.opcache_interned.used_memory+this.opcache_interned.free_memory,this.opcache_interned.used_memory_percentage=parseFloat(this.opcache_interned.used_memory/this.opcache_interned.total_memory*100).toFixed(5)},opcacheStartTimeTooltip:function(){var t="".concat(this.tt("started")," ")+"".concat(new Date(1e3*this.opcache_stats.start_time).toLocaleString());return this.opcache_stats.last_restart_time&&(t=t.concat("<br><br>".concat(this.tt("last-restart")," ")+"".concat(new Date(1e3*this.opcache_stats.last_restart_time).toLocaleString()))),{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}},opcacheStatsTooltip:function(){var t="".concat(parseFloat(this.opcache_stats.hits).toLocaleString()," ").concat(this.tt("hits"),"<br>")+"".concat(parseFloat(this.opcache_stats.misses).toLocaleString()," ").concat(this.tt("misses"),"<br><br>")+"".concat(parseFloat(this.opcache_stats.num_cached_scripts).toLocaleString()," ").concat(this.tt("scripts"),"<br>")+"".concat(parseFloat(this.opcache_stats.num_cached_keys).toLocaleString()," ").concat(this.tt("keys"),"<br>")+"".concat(parseFloat(this.opcache_stats.max_cached_keys).toLocaleString()," ").concat(this.tt("max-keys"),"<br>");return{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}},opcacheMemoryUsageTooltip:function(){var t="PHP opcache ".concat(this.tt("memory-utilisation"),"<br><br>")+"".concat(this.convertBytes(this.opcache.memory_usage.total_memory)," ").concat(this.tt("total"),"<br>")+"".concat(this.convertBytes(this.opcache.memory_usage.used_memory)," ").concat(this.tt("used"),"<br>")+"".concat(this.convertBytes(this.opcache.memory_usage.free_memory)," ").concat(this.tt("free"),"<br><br>")+"".concat(this.convertBytes(this.opcache.memory_usage.wasted_memory)," (")+"".concat(parseFloat(this.opcache.memory_usage.current_wasted_percentage).toFixed(1),"%) ").concat(this.tt("wasted"));return{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}},opcacheInternedStringsTooltip:function(){var t="PHP opcache interned strings<br><br>"+"".concat(this.convertBytes(this.opcache_interned.buffer_size)," ").concat(this.tt("total")," ").concat(this.tt("memory"),"<br>")+"".concat(this.convertBytes(this.opcache_interned.used_memory)," ").concat(this.tt("used")," ").concat(this.tt("memory"),"<br>")+"".concat(this.convertBytes(this.opcache_interned.free_memory)," ").concat(this.tt("free")," ").concat(this.tt("memory"),"<br><br>")+"".concat(parseFloat(this.opcache_interned.number_of_strings).toLocaleString())+" strings";return{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}}},created:function(){this.overrideUpdateInterval=60}},c=r,l=(s("06c8"),s("2877")),h=Object(l["a"])(c,o,a,!1,null,"51253a44",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-468d3a74.a256f3b4.js.map