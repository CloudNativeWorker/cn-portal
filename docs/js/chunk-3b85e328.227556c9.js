(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b85e328"],{"1c8e":function(t,s,e){"use strict";e("99af"),e("e9c4"),e("d3b7");var a=e("cee4"),i=e("d445"),o=e("3136"),n=e("5cc6"),r={props:{options:{type:Object,default:{}}},data:function(){return{progress:new i["a"]({color:"var(--progress-bar)"}),overrideProxyChoice:!1,overrideUpdateInterval:null,disableLoader:!1,updater:null,defaultTimeout:5e4}},mounted:function(){this.fetchData(),this.updateInterval&&(this.continuousUpdates(),this.disableLoader=!0)},beforeDestroy:function(){this.updater&&clearInterval(this.updater)},computed:{proxyReqEndpoint:function(){var t=Object({NODE_ENV:"production",VUE_APP_VERSION:"2.1.2",BASE_URL:"/"}).VUE_APP_DOMAIN||window.location.origin;return"".concat(t).concat(n["serviceEndpoints"].corsProxy)},useProxy:function(){return this.options.useProxy||this.overrideProxyChoice},updateInterval:function(){var t=this.options.updateInterval;return null===t&&this.overrideUpdateInterval?1e3*this.overrideUpdateInterval:t?"boolean"===typeof t?3e4:"number"===typeof t&&t>=2&&t<=7200?1e3*t:0:0}},methods:{update:function(){this.startLoading(),this.fetchData()},continuousUpdates:function(){var t=this;this.updater=setInterval((function(){t.update()}),this.updateInterval)},error:function(t,s){Object(o["e"])(t,s),this.options.ignoreErrors||this.$emit("error",t)},startLoading:function(){this.disableLoader||(this.$emit("loading",!0),this.progress.start())},finishLoading:function(){var t=this;this.$emit("loading",!1),setTimeout((function(){t.progress.end()}),500)},fetchData:function(){this.finishLoading()},tooltip:function(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{content:t,html:s,trigger:"hover focus",delay:250}},makeRequest:function(t,s,e,i){var o=this,n=e||"GET",r=this.useProxy?this.proxyReqEndpoint:t,l=JSON.stringify(i||{}),c=s||null,u=this.useProxy?{"Target-URL":t,CustomHeaders:JSON.stringify(c)}:c,d=this.options.timeout||this.defaultTimeout,h={method:n,url:r,headers:u,data:l,timeout:d};return new Promise((function(t,s){a["a"].request(h).then((function(s){!1===s.data.success&&o.error("Proxy returned error from target server",s.data.message),t(s.data)})).catch((function(t){o.error("Unable to fetch data",t),s(t)})).finally((function(){o.finishLoading()}))}))}}};s["a"]=r},"2c3a":function(t,s,e){"use strict";var a=e("3835"),i=(e("99af"),e("caad"),e("d81d"),e("b680"),e("d3b7"),e("ac1f"),e("00b4"),e("25f0"),e("2532"),e("466d"),e("498a"),e("313d"),e("0eb6"),e("b7ef"),e("8bd4"),e("5cc6")),o=e("b96f");s["a"]={data:function(){return{validCredentials:null,capabilities:{notifications:{enabled:null,features:[]},userStatus:null},capabilitiesLastUpdated:0,branding:{name:null,logo:null,url:null,slogan:null},version:{string:null,edition:null}}},computed:{hostname:function(){return this.options.hostname||this.error("A hostname is required"),this.options.hostname},username:function(){return this.options.username||this.error("A username is required"),this.options.username},password:function(){return this.options.password||this.error("An app-password is required"),/^([a-z0-9]{5}-){4}[a-z0-9]{5}$/i.test(this.options.password)?this.options.password:(this.error("Please use a Nextcloud app-password, not your login password."),"")},headers:function(){var t="".concat(this.username,":").concat(this.password);return{"OCS-APIREQUEST":!0,Accept:"application/json",Authorization:"Basic ".concat(window.btoa(t))}},capabilitiesTtl:function(){return 1e3*(parseInt(this.options.capabilitiesTtl,10)||3600)},proxyReqEndpoint:function(){var t=Object({NODE_ENV:"production",VUE_APP_VERSION:"2.1.2",BASE_URL:"/"}).VUE_APP_DOMAIN||window.location.origin;return"".concat(t).concat(i["serviceEndpoints"].corsProxy)}},methods:{endpoint:function(t){switch(t){case"user":return"".concat(this.hostname,"/ocs/v1.php/cloud/users/").concat(this.username);case"userstatus":return"".concat(this.hostname,"/ocs/v2.php/apps/user_status/api/v1/statuses");case"serverinfo":return"".concat(this.hostname,"/ocs/v2.php/apps/serverinfo/api/v1/info");case"notifications":return"".concat(this.hostname,"/ocs/v2.php/apps/notifications/api/v2/notifications");case"capabilities":default:return"".concat(this.hostname,"/ocs/v1.php/cloud/capabilities")}},hasValidCredentials:function(){return!1!==this.validCredentials&&this.username.length>0&&this.password.length>0},validateResponse:function(t){var s,e,a=null===t||void 0===t||null===(s=t.ocs)||void 0===s?void 0:s.data,i=null===t||void 0===t||null===(e=t.ocs)||void 0===e?void 0:e.meta,o=null===t||void 0===t?void 0:t.error;switch(o&&o.status&&(i={statuscode:o.status}),i&&i.statuscode&&a||this.error("Invalid response"),i.statuscode){case 401:this.validCredentials=!1,this.error("Access denied for user ".concat(this.username,".")+" Note that some Nextcloud widgets only work with an admin user.");break;case 429:this.validCredentials=!1,this.error("The server indicated 'rate-limit reached' error (HTTP 429). The server-info API may return this error for incorrect user/password.");break;case 993:case 997:case 998:this.validCredentials=!1,this.error("The provided app-password is not permitted to access the requested resource or it has been revoked, or the username/password combination is incorrect");break;default:this.validCredentials=!0,this.allowedStatuscodes().includes(i.statuscode)||this.error("Unexpected response");break}return a},loadCapabilities:function(){return(new Date).getTime()-this.capabilitiesLastUpdated>this.capabilitiesTtl?this.makeRequest(this.endpoint("capabilities"),this.headers).then(this.processCapabilities):Promise.resolve()},processCapabilities:function(t){var s,e,a,i,o,n=this.validateResponse(t),r=null===(s=n.capabilities)||void 0===s||null===(s=s.notifications)||void 0===s?void 0:s["ocs-endpoints"];this.branding=null===(e=n.capabilities)||void 0===e?void 0:e.theming,this.capabilities.notifications.enabled=!(null===r||void 0===r||!r.length),this.capabilities.notifications.features=r||[],this.capabilities.userStatus=!(null===(a=n.capabilities)||void 0===a||null===(a=a.user_status)||void 0===a||!a.enabled),this.version.string=null===(i=n.version)||void 0===i?void 0:i.string,this.version.edition=null===(o=n.version)||void 0===o?void 0:o.edition,this.capabilitiesLastUpdated=(new Date).getTime()},getTimeAgo:function(t){return Object(o["l"])(t)},formatDateTime:function(t){return Object(o["s"])(t)},convertBytes:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Object(o["d"])(t,s).toString();if(!e)return a;var i=a.match(/(-?\d+)((\.\d+)?\s(([KMGTPEZY]B|Bytes)))/);return"".concat(i[1],'<span class="decimals">').concat(i[2],"</span>")},formatNumber:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Object(o["g"])(t,s).toString();if(!e)return a;var i=a.match(/(\d+)((\.\d+)?([KMBT]?))/);return"".concat(i[1],'<span class="decimals">').concat(i[2],"</span>")},formatPercent:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=parseFloat(t).toFixed(s).split("."),a=e.length>1?".".concat(e[1]):"";return"".concat(e[0],'<span class="decimals">').concat(a,"%</span>")},getValueFromCss:function(t){var s=getComputedStyle(this.$el||document.documentElement);return s.getPropertyValue("--".concat(t)).trim()},getColorRgba:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=this.getValueFromCss(t).match(/\w\w/g).map((function(t){return parseInt(t,16)})),i=Object(a["a"])(e,3),o=i[0],n=i[1],r=i[2];return"rgba(".concat(o,",").concat(n,",").concat(r,",").concat(s,")")},tt:function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.$t("widgets.nextcloud.".concat(t),s)}}}},"9a75":function(t,s,e){"use strict";e("aaa9")},aaa9:function(t,s,e){},f9cc:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t._self._c;return t.didLoadData?s("div",{staticClass:"nextcloud-widget nextcloud-stats-wrapper"},[s("div",{staticClass:"server-info sep"},[t.activeUsers?s("div",[s("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.activeUsersTooltip(),expression:"activeUsersTooltip()"}]},[s("i",{staticClass:"fal fa-user"}),s("em",{domProps:{innerHTML:t._s(t.formatNumber(t.storage.num_users))}}),s("strong",[t._v(t._s(t.tt("total-users")))]),t._v(" "),s("small",[t._v(t._s(t.tt("of-which")))]),s("em",{domProps:{innerHTML:t._s(t.formatNumber(t.activeUsers.last24hours))}}),s("strong",[t._v(t._s(t.tt("active")))]),t._v(" "),s("small",[t._v("("+t._s(t.tt("last-24-hours"))+")")])])]):t._e(),s("hr"),t.nextcloud?s("div",[s("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.appUpdatesTooltip(),expression:"appUpdatesTooltip()"}]},[s("i",{staticClass:"fal fa-browser"}),s("em",{domProps:{innerHTML:t._s(t.formatNumber(t.apps.num_installed))}}),s("strong",[t._v(t._s(t.tt("applications")))]),t.apps.num_updates_available?s("span",{staticClass:"nc-updates"},[s("i",{staticClass:"fal fa-download"}),s("em",[t._v(t._s(t.apps.num_updates_available))]),s("strong",[t._v(" "+t._s(t.tt("updates-available",{plural:t.apps.num_updates_available>1?"s":""}))+" ")])]):s("small",{staticClass:"disabled",attrs:{"data-nc-updates":""}},[t._v(t._s(t.tt("no-pending-updates")))])]),s("hr"),s("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.storagesTooltip(),expression:"storagesTooltip()"}]},[s("i",{staticClass:"fal fa-file"}),s("em",{domProps:{innerHTML:t._s(t.formatNumber(t.storage.num_files))}}),s("strong",[t._v(t._s(t.tt("files",{plural:t.storage.num_files>1?"s":""})))]),t._v("  "),s("small",[t._v(t._s(t.tt("in")))]),s("em",[t._v(t._s(t.storage.num_storages))]),s("strong",[t._v(t._s(t.tt("storages",{plural:t.storage.num_storages>1?"s":""})))]),t._v("  • "),s("strong",{domProps:{innerHTML:t._s(t.convertBytes(t.system.freespace))}}),t._v("  "),s("small",[t._v(t._s(t.tt("free")))])]),s("hr"),s("p",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.sharesTooltip(),expression:"sharesTooltip()"}]},[s("i",{staticClass:"fal fa-share"}),s("em",{domProps:{innerHTML:t._s(t.formatNumber(t.shares.num_shares))}}),s("strong",[t._v(t._s(t.tt("local")))]),t._v(" "),s("small",[t._v(" "+t._s(t.tt("and")))]),s("em",{domProps:{innerHTML:t._s(t.formatNumber(t.shares.num_fed_shares_sent+t.shares.num_fed_shares_received))}}),s("strong",[t._v(" "+t._s(t.tt("federated-shares"))+" ")])]),s("hr")]):t._e()])]):t._e()},i=[],o=e("3835"),n=(e("99af"),e("4fad"),e("d3b7"),e("159b"),e("1c8e")),r=e("2c3a"),l={mixins:[n["a"],r["a"]],components:{},data:function(){return{nextcloud:{system:{freespace:null,apps:{num_installed:null,num_updates_available:0,app_updates:[]}},storage:{num_users:null,num_files:null,num_storages:null},shares:{num_shares:null,num_shares_user:null,num_shares_groups:null,num_shares_link:null,num_shares_mail:null,num_shares_room:null,num_shares_link_no_password:null,num_fed_shares_sent:null,num_fed_shares_received:null}},activeUsers:{last5minutes:null,last1hour:null,last24hours:null}}},computed:{didLoadData:function(){var t;return!(null===this||void 0===this||null===(t=this.system)||void 0===t||!t.freespace)},system:function(){return this.nextcloud.system},storage:function(){return this.nextcloud.storage},shares:function(){return this.nextcloud.shares},apps:function(){return this.nextcloud.system.apps}},methods:{allowedStatuscodes:function(){return[200]},fetchData:function(){this.hasValidCredentials()&&this.makeRequest(this.endpoint("serverinfo"),this.headers).then(this.processServerInfo).finally(this.finishLoading)},processServerInfo:function(t){var s=this.validateResponse(t);this.nextcloud=s.nextcloud,this.activeUsers=s.activeUsers},activeUsersTooltip:function(){var t="".concat(parseFloat(this.activeUsers.last5minutes).toLocaleString())+" ".concat(this.tt("last-5-minutes"),"<br>")+"".concat(parseFloat(this.activeUsers.last1hour).toLocaleString())+" ".concat(this.tt("last-hour"),"<br>");return{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}},appUpdatesTooltip:function(){var t="<strong>".concat(this.tt("updates-available-for"),"</strong><ul>");return Object.entries(this.system.apps.app_updates).forEach((function(s){var e=Object(o["a"])(s,2),a=e[0],i=e[1];t+="<li>".concat(a,": ").concat(i,"</li>")})),t+="</ul>",{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}},storagesTooltip:function(){var t="<strong>".concat(this.tt("storages-by-type"),"</strong><ul><li>")+"".concat(parseFloat(this.storage.num_storages_local).toLocaleString()," ").concat(this.tt("local"),"</li><li>")+"".concat(parseFloat(this.storage.num_storages_home).toLocaleString()," ").concat(this.tt("home"),"</li><li>")+"".concat(parseFloat(this.storage.num_storages_other).toLocaleString()," ").concat(this.tt("other"),"</li></ul>")+"".concat(parseFloat(this.storage.num_files).toLocaleString()," ").concat(this.tt("total-files"));return{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}},sharesTooltip:function(){var t="<strong>".concat(this.tt("local-shares"),"</strong><ul><li>")+"".concat(parseFloat(this.shares.num_shares_user).toLocaleString()," ").concat(this.tt("user"),"</li><li>")+"".concat(parseFloat(this.shares.num_shares_groups).toLocaleString()," ").concat(this.tt("groups"),"</li><li>")+"".concat(parseFloat(this.shares.num_shares_mail).toLocaleString()," ").concat(this.tt("email"),"</li><li>")+"".concat(parseFloat(this.shares.num_shares_room).toLocaleString()," ").concat(this.tt("chat-room"),"</li><li>")+"".concat(parseFloat(this.shares.num_shares_link).toLocaleString()," ").concat(this.tt("private-link"),"</li><li>")+"".concat(parseFloat(this.shares.num_shares_link_no_password).toLocaleString()," ").concat(this.tt("public-link"),"</li></ul>")+"<strong>".concat(this.tt("federated-shares-ucfirst"),"</strong><ul><li>")+"".concat(parseFloat(this.shares.num_fed_shares_sent).toLocaleString()," ").concat(this.tt("sent"),"</li><li>")+"".concat(parseFloat(this.shares.num_fed_shares_received).toLocaleString()," ").concat(this.tt("received"),"</li></ul>");return{content:t,html:!0,trigger:"hover focus",delay:250,classes:"nc-tooltip"}}},created:function(){this.overrideUpdateInterval=20}},c=l,u=(e("9a75"),e("2877")),d=Object(u["a"])(c,a,i,!1,null,"ff16f3da",null);s["default"]=d.exports}}]);
//# sourceMappingURL=chunk-3b85e328.227556c9.js.map