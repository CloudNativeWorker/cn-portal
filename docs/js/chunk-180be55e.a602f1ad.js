(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-180be55e"],{"2c3a":function(e,t,a){"use strict";var r=a("3835"),s=(a("99af"),a("caad"),a("d81d"),a("b680"),a("d3b7"),a("ac1f"),a("00b4"),a("25f0"),a("2532"),a("466d"),a("498a"),a("313d"),a("0eb6"),a("b7ef"),a("8bd4"),a("5cc6")),n=a("b96f");t["a"]={data:function(){return{validCredentials:null,capabilities:{notifications:{enabled:null,features:[]},userStatus:null},capabilitiesLastUpdated:0,branding:{name:null,logo:null,url:null,slogan:null},version:{string:null,edition:null}}},computed:{hostname:function(){return this.options.hostname||this.error("A hostname is required"),this.options.hostname},username:function(){return this.options.username||this.error("A username is required"),this.options.username},password:function(){return this.options.password||this.error("An app-password is required"),/^([a-z0-9]{5}-){4}[a-z0-9]{5}$/i.test(this.options.password)?this.options.password:(this.error("Please use a Nextcloud app-password, not your login password."),"")},headers:function(){var e="".concat(this.username,":").concat(this.password);return{"OCS-APIREQUEST":!0,Accept:"application/json",Authorization:"Basic ".concat(window.btoa(e))}},capabilitiesTtl:function(){return 1e3*(parseInt(this.options.capabilitiesTtl,10)||3600)},proxyReqEndpoint:function(){var e=Object({NODE_ENV:"production",VUE_APP_VERSION:"2.1.2",BASE_URL:"/"}).VUE_APP_DOMAIN||window.location.origin;return"".concat(e).concat(s["serviceEndpoints"].corsProxy)}},methods:{endpoint:function(e){switch(e){case"user":return"".concat(this.hostname,"/ocs/v1.php/cloud/users/").concat(this.username);case"userstatus":return"".concat(this.hostname,"/ocs/v2.php/apps/user_status/api/v1/statuses");case"serverinfo":return"".concat(this.hostname,"/ocs/v2.php/apps/serverinfo/api/v1/info");case"notifications":return"".concat(this.hostname,"/ocs/v2.php/apps/notifications/api/v2/notifications");case"capabilities":default:return"".concat(this.hostname,"/ocs/v1.php/cloud/capabilities")}},hasValidCredentials:function(){return!1!==this.validCredentials&&this.username.length>0&&this.password.length>0},validateResponse:function(e){var t,a,r=null===e||void 0===e||null===(t=e.ocs)||void 0===t?void 0:t.data,s=null===e||void 0===e||null===(a=e.ocs)||void 0===a?void 0:a.meta,n=null===e||void 0===e?void 0:e.error;switch(n&&n.status&&(s={statuscode:n.status}),s&&s.statuscode&&r||this.error("Invalid response"),s.statuscode){case 401:this.validCredentials=!1,this.error("Access denied for user ".concat(this.username,".")+" Note that some Nextcloud widgets only work with an admin user.");break;case 429:this.validCredentials=!1,this.error("The server indicated 'rate-limit reached' error (HTTP 429). The server-info API may return this error for incorrect user/password.");break;case 993:case 997:case 998:this.validCredentials=!1,this.error("The provided app-password is not permitted to access the requested resource or it has been revoked, or the username/password combination is incorrect");break;default:this.validCredentials=!0,this.allowedStatuscodes().includes(s.statuscode)||this.error("Unexpected response");break}return r},loadCapabilities:function(){return(new Date).getTime()-this.capabilitiesLastUpdated>this.capabilitiesTtl?this.makeRequest(this.endpoint("capabilities"),this.headers).then(this.processCapabilities):Promise.resolve()},processCapabilities:function(e){var t,a,r,s,n,i=this.validateResponse(e),o=null===(t=i.capabilities)||void 0===t||null===(t=t.notifications)||void 0===t?void 0:t["ocs-endpoints"];this.branding=null===(a=i.capabilities)||void 0===a?void 0:a.theming,this.capabilities.notifications.enabled=!(null===o||void 0===o||!o.length),this.capabilities.notifications.features=o||[],this.capabilities.userStatus=!(null===(r=i.capabilities)||void 0===r||null===(r=r.user_status)||void 0===r||!r.enabled),this.version.string=null===(s=i.version)||void 0===s?void 0:s.string,this.version.edition=null===(n=i.version)||void 0===n?void 0:n.edition,this.capabilitiesLastUpdated=(new Date).getTime()},getTimeAgo:function(e){return Object(n["l"])(e)},formatDateTime:function(e){return Object(n["s"])(e)},convertBytes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(n["d"])(e,t).toString();if(!a)return r;var s=r.match(/(-?\d+)((\.\d+)?\s(([KMGTPEZY]B|Bytes)))/);return"".concat(s[1],'<span class="decimals">').concat(s[2],"</span>")},formatNumber:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(n["g"])(e,t).toString();if(!a)return r;var s=r.match(/(\d+)((\.\d+)?([KMBT]?))/);return"".concat(s[1],'<span class="decimals">').concat(s[2],"</span>")},formatPercent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=parseFloat(e).toFixed(t).split("."),r=a.length>1?".".concat(a[1]):"";return"".concat(a[0],'<span class="decimals">').concat(r,"%</span>")},getValueFromCss:function(e){var t=getComputedStyle(this.$el||document.documentElement);return t.getPropertyValue("--".concat(e)).trim()},getColorRgba:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this.getValueFromCss(e).match(/\w\w/g).map((function(e){return parseInt(e,16)})),s=Object(r["a"])(a,3),n=s[0],i=s[1],o=s[2];return"rgba(".concat(n,",").concat(i,",").concat(o,",").concat(t,")")},tt:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.$t("widgets.nextcloud.".concat(e),t)}}}},"2f96":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return e.didLoadData?t("div",{staticClass:"nextcloud-widget nextcloud-system-wrapper"},[t("div",{staticClass:"charts"},[t("div",{staticClass:"chart-container"},[t("small",[e._v(e._s(e.tt("overall"))+" "+e._s(e.tt("memory-utilisation")))]),t("GaugeChart",{attrs:{value:e.memoryGauge.value,baseColor:e.memoryGauge.background,gaugeColor:e.memoryGauge.color}},[t("p",{staticClass:"percentage"},[e._v(e._s(e.memoryGauge.value)+"%")])]),t("small",[e._v(e._s(e.getMemoryGaugeLabel()))])],1),t("div",[t("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("widgets.glances.system-load-desc"),expression:"$t('widgets.glances.system-load-desc')"}],staticClass:"load-chart",attrs:{id:e.cpuLoadChartId}})])]),t("div",[t("hr"),t("p",[t("i",{staticClass:"fal fa-server"}),t("strong",[e._v("Nextcloud")]),t("em",[e._v(e._s(e.server.nextcloud.system.version))]),e._v(" "),t("small",[e._v("â€¢ ")]),t("strong",[e._v(e._s(e.server.server.webserver)+"/PHP")]),t("em",[e._v(e._s(e.server.server.php.version))])]),t("hr"),t("p",[t("i",{staticClass:"fal fa-database"}),t("strong",[e._v(e._s(e.server.server.database.type))]),t("em",[e._v(e._s(e.server.server.database.version))]),e._v(" "),t("small",[e._v(e._s(e.tt("using")))]),t("em",{domProps:{innerHTML:e._s(e.convertBytes(e.server.server.database.size))}})]),t("hr")])]):e._e()},s=[],n=a("c7eb"),i=a("1da1"),o=(a("99af"),a("fb6a"),a("b680"),a("d3b7"),a("25f0"),a("1c8e")),c=a("2c3a"),l=a("c7f3"),u=a("e599"),d={mixins:[o["a"],c["a"],u["a"]],components:{GaugeChart:l["a"]},data:function(){return{server:{server:{database:{type:null,version:null,size:null},webserver:null,php:{version:null}},nextcloud:{system:{version:null,freespace:null,cpuload:[],mem_total:null,mem_free:null,mem_percent:null}}},memoryGauge:{value:0,color:"#272f4d",showMoreInfo:!1,moreInfo:null,background:"#16161d"}}},computed:{cpuLoadChartId:function(){return"nextcloud-cpu-load-chart-".concat(Math.random().toString().slice(-4))},didLoadData:function(){var e;return!(null===(e=this.server)||void 0===e||null===(e=e.nextcloud)||void 0===e||null===(e=e.system)||void 0===e||!e.version)}},methods:{allowedStatuscodes:function(){return[200]},fetchData:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.hasValidCredentials()){t.next=2;break}return t.abrupt("return");case 2:e.makeRequest(e.endpoint("serverinfo"),e.headers).then(e.processServerInfo).finally((function(){return e.finishLoading()}));case 3:case"end":return t.stop()}}),t)})))()},processServerInfo:function(e){var t,a,r,s,n=this.validateResponse(e);n&&0!==n.length&&(this.server.nextcloud.system=null===(t=n.nextcloud)||void 0===t?void 0:t.system,this.server.server.php.version=null===(a=n.server)||void 0===a||null===(a=a.php)||void 0===a?void 0:a.version,this.server.server.database=null===(r=n.server)||void 0===r?void 0:r.database,this.server.server.webserver=null===(s=n.server)||void 0===s?void 0:s.webserver)},updateMemoryGauge:function(e){this.memoryGauge.value=parseFloat(((e.mem_total-e.mem_free)/e.mem_total*100).toFixed(2)),this.memoryGauge.color=this.getMemoryGaugeColor(this.memoryGauge.value)},updateOpcacheMemory:function(){this.opcache_stats.opcache_hit_rate=parseFloat(this.opcache_stats.opcache_hit_rate).toFixed(3),this.opcache.memory_usage.total_memory=this.opcache.memory_usage.used_memory+this.opcache.memory_usage.free_memory,this.opcache.memory_usage.used_memory_percentage=parseFloat(this.opcache.memory_usage.used_memory/this.opcache.memory_usage.total_memory*100).toFixed(1)},updateOpcacheInterned:function(){this.opcache.interned_strings_usage.total_memory=this.opcache.interned_strings_usage.used_memory+this.opcache.interned_strings_usage.free_memory,this.opcache.interned_strings_usage.used_memory_percentage=parseFloat(this.opcache.interned_strings_usage.used_memory/this.opcache.interned_strings_usage.total_memory*100).toFixed(5)},getMemoryGaugeColor:function(e){return e<50?this.getColorRgba("widget-text-color",.6):e<60?this.getColorRgba("warning",.75):e<80?this.getColorRgba("error",.9):e<100?this.getColorRgba("danger"):this.getColorRgba("background")},getMemoryGaugeLabel:function(){var e=this.server.nextcloud.system;return"".concat(this.convertBytes(1024*(e.mem_total-e.mem_free),2,!1)," / ")+"".concat(this.convertBytes(1024*e.mem_total,2,!1))},updateCpuLoad:function(e){var t={labels:["1m","5m","15m"],datasets:[{values:[e[0],e[1],e[2]]}]},a=this.tt("load-averages");this.renderCpuLoadChart(t,a)},renderCpuLoadChart:function(e,t){var a=this;return new this.Chart("#".concat(this.cpuLoadChartId),{title:t,data:e,type:"bar",height:180,colors:[this.getColorRgba("widget-text-color",.6)],barOptions:{spaceRatio:.2},tooltipOptions:{formatTooltipY:function(e){return"".concat(e," ").concat(a.tt("tasks"))}}})}},created:function(){this.overrideUpdateInterval=30},updated:function(){var e,t=null===(e=this.server)||void 0===e||null===(e=e.nextcloud)||void 0===e||null===(e=e.system)||void 0===e?void 0:e.cpuload;t&&this.updateCpuLoad(t);var a=this.server.nextcloud.system;a&&this.updateMemoryGauge(a)}},h=d,p=(a("a811"),a("2877")),v=Object(p["a"])(h,r,s,!1,null,"9f1b66b2",null);t["default"]=v.exports},6746:function(e,t,a){},"79a5":function(e,t,a){"use strict";a("c91f")},a811:function(e,t,a){"use strict";a("6746")},c7f3:function(e,t,a){"use strict";a("99af");var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"gauge"},[e.height?t("svg",{attrs:{viewBox:"0 0 ".concat(2*e.RADIUS," ").concat(e.height),height:"100%",width:"100%",xmlns:"http://www.w3.org/2000/svg"}},[t("defs",[t("filter",{attrs:{id:"innershadow-".concat(e._uid)}},[t("feFlood",{attrs:{"flood-color":e.shadowColor}}),t("feComposite",{attrs:{in2:"SourceAlpha",operator:"out"}}),t("feGaussianBlur",{attrs:{stdDeviation:"2",result:"blur"}}),t("feComposite",{attrs:{operator:"atop",in2:"SourceGraphic"}})],1),e.hasGradient?t("linearGradient",{attrs:{id:"gaugeGradient-".concat(e._uid)}},e._l(e.gaugeColor,(function(e,a){return t("stop",{key:"".concat(e.color,"-").concat(a),attrs:{offset:"".concat(e.offset,"%"),"stop-color":e.color}})})),1):e._e(),t("mask",{attrs:{id:"innerCircle-".concat(e._uid)}},[t("circle",{attrs:{r:e.RADIUS-.5,cx:e.X_CENTER,cy:e.Y_CENTER,fill:"white"}}),t("circle",{attrs:{r:e.innerRadius,cx:e.X_CENTER,cy:e.Y_CENTER,fill:"black"}}),e.separatorPaths?e._l(e.separatorPaths,(function(e,a){return t("path",{key:a,attrs:{d:e,fill:"black"}})})):e._e()],2)],1),t("g",{attrs:{mask:"url(#innerCircle-".concat(e._uid,")")}},[e.isCircle?t("circle",{attrs:{r:e.RADIUS,cx:e.X_CENTER,cy:e.Y_CENTER,fill:e.hasGradient?"url(#gaugeGradient-".concat(e._uid,")"):e.gaugeColor}}):t("path",{attrs:{d:e.basePath,fill:e.hasGradient?"url(#gaugeGradient-".concat(e._uid,")"):e.gaugeColor}}),e.value===e.min&&e.isCircle?t("circle",{attrs:{r:e.RADIUS,cx:e.X_CENTER,cy:e.Y_CENTER,fill:e.baseColor}}):t("path",{attrs:{d:e.gaugePath,fill:e.baseColor,filter:"url(#innershadow-".concat(e._uid,")")}})]),e.scaleLines?e._l(e.scaleLines,(function(a,r){return t("line",{key:"".concat(a.xE,"-").concat(r),attrs:{x1:a.xS,y1:a.yS,x2:a.xE,y2:a.yE,"stroke-width":"1",stroke:e.baseColor}})})):e._e(),t("foreignObject",{attrs:{x:"0",y:"0",width:"100%",height:e.height}},[e._t("default")],2)],2):e._e()])},s=[],n=(a("a15b"),a("14d9"),a("a9e3"),a("3136")),i=100,o=100,c=100;function l(e,t){var a=(t-90)*(Math.PI/180);return{x:o+e*Math.cos(a),y:c+e*Math.sin(a)}}function u(e,t,a){var r=l(e,a),s=l(e,t),n=a-t<=180?"0":"1",i=["M",r.x,r.y,"A",e,e,0,n,0,s.x,s.y,"L",o,c].join(" ");return i}var d={name:"Gauge",props:{value:{type:Number,default:70},min:{type:Number,default:0},max:{type:Number,default:100},startAngle:{type:Number,default:-90,validator:function(e){return(e<-360||e>360)&&Object(n["e"])('Gauge Chart - Expected prop "startAngle" to be between -360 and 360'),!0}},endAngle:{type:Number,default:90,validator:function(e){return(e<-360||e>360)&&Object(n["e"])('Gauge Chart - Expected prop "endAngle" to be between -360 and 360'),!0}},innerRadius:{type:Number,default:60,validator:function(e){return(e<0||e>100)&&Object(n["e"])('Gauge Chart - Expected prop "innerRadius" to be between 0 and '.concat(i)),!0}},separatorStep:{type:Number,default:20,validator:function(e){return null!==e&&e<0&&Object(n["e"])('Gauge Chart - Expected prop "separatorStep" to be null or >= 0'),!0}},separatorThickness:{type:Number,default:4},gaugeColor:{type:[Array,String],default:function(){return[{offset:0,color:"#20e253"},{offset:30,color:"#f6f000"},{offset:60,color:"#fca016"},{offset:80,color:"#f80363"}]}},baseColor:{type:String,default:"#DDDDDD"},shadowColor:{type:String,default:"#8787871a"},scaleInterval:{type:Number,default:5,validator:function(e){return null!==e&&e<0&&Object(n["e"])('Gauge Chart - Expected prop "scaleInterval" to be null or >= 0'),!0}},transitionDuration:{type:Number,default:1500}},data:function(){return{X_CENTER:o,Y_CENTER:c,RADIUS:i,tweenedValue:this.min}},computed:{height:function(){var e=this.endAngle,t=this.startAngle,a=l(i,t),r=a.y,s=l(i,e),n=s.y;return Math.abs(e)<=180&&Math.abs(t)<=180?Math.max(c,r,n):2*i},basePath:function(){var e=this.startAngle,t=this.endAngle;return u(i,e,t)},gaugePath:function(){var e=this.endAngle,t=this.getAngle,a=this.tweenedValue;return u(i,t(a),e)},totalAngle:function(){var e=this.startAngle,t=this.endAngle;return Math.abs(t-e)},isCircle:function(){return 360===Math.abs(this.totalAngle)},hasGradient:function(){return Array.isArray(this.gaugeColor)},separatorPaths:function(){var e=this.separatorStep,t=this.getAngle,a=this.min,r=this.max,s=this.separatorThickness,n=this.isCircle;if(e>0){var o=[],c=n?a:a+e;for(c;c<r;c+=e){var l=t(c),d=s/2;o.push(u(i+2,l-d,l+d))}return o}return null},scaleLines:function(){var e=this.scaleInterval,t=this.isCircle,a=this.min,r=this.max,s=this.getAngle,n=this.innerRadius;if(e>0){var i=[],o=t?a+e:a;for(o;o<r+e;o+=e){var c=s(o),u=l(n-4,c),d=l(n-8,c);i.push({xS:u.x,yS:u.y,xE:d.x,yE:d.y})}return i}return null},logScale:function(){for(var e=[],t=this.max;t>1;t-=1)e.push(Math.round(Math.log(t)));return e}},watch:{value:function(e){this.animateTo(e)}},methods:{getAngle:function(e){var t=this.min,a=this.max,r=this.startAngle,s=this.totalAngle,n=a-t||1;return e*s/n+r},animateTo:function(e){var t=this,a=this.tweenedValue,r=0,s=a<e,n=function n(){a=s?a+1:a-1,r+=1,setTimeout((function(){(s&&a<=e||!s&&a>=e)&&(t.tweenedValue=a,n())}),t.logScale[r])};n()}},mounted:function(){this.animateTo(this.value)}},h=d,p=(a("79a5"),a("2877")),v=Object(p["a"])(h,r,s,!1,null,null,null);t["a"]=v.exports},c91f:function(e,t,a){}}]);
//# sourceMappingURL=chunk-180be55e.a602f1ad.js.map